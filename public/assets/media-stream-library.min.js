/*! For license information please see media-stream-library.min.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.mediaStreamLibrary=t():e.mediaStreamLibrary=t()}(self,(function(){return(()=>{var e={742:(e,t)=>{"use strict";t.byteLength=function(e){var t=c(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){var t,n,o=c(e),s=o[0],a=o[1],u=new i(function(e,t,n){return 3*(t+n)/4-n}(0,s,a)),l=0,h=a>0?s-4:s;for(n=0;n<h;n+=4)t=r[e.charCodeAt(n)]<<18|r[e.charCodeAt(n+1)]<<12|r[e.charCodeAt(n+2)]<<6|r[e.charCodeAt(n+3)],u[l++]=t>>16&255,u[l++]=t>>8&255,u[l++]=255&t;return 2===a&&(t=r[e.charCodeAt(n)]<<2|r[e.charCodeAt(n+1)]>>4,u[l++]=255&t),1===a&&(t=r[e.charCodeAt(n)]<<10|r[e.charCodeAt(n+1)]<<4|r[e.charCodeAt(n+2)]>>2,u[l++]=t>>8&255,u[l++]=255&t),u},t.fromByteArray=function(e){for(var t,r=e.length,i=r%3,o=[],s=16383,a=0,c=r-i;a<c;a+=s)o.push(u(e,a,a+s>c?c:a+s));return 1===i?(t=e[r-1],o.push(n[t>>2]+n[t<<4&63]+"==")):2===i&&(t=(e[r-2]<<8)+e[r-1],o.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"=")),o.join("")};for(var n=[],r=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,a=o.length;s<a;++s)n[s]=o[s],r[o.charCodeAt(s)]=s;function c(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function u(e,t,r){for(var i,o,s=[],a=t;a<r;a+=3)i=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),s.push(n[(o=i)>>18&63]+n[o>>12&63]+n[o>>6&63]+n[63&o]);return s.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},764:(e,t,n)=>{"use strict";const r=n(742),i=n(645),o="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=c,t.SlowBuffer=function(e){return+e!=e&&(e=0),c.alloc(+e)},t.INSPECT_MAX_BYTES=50;const s=2147483647;function a(e){if(e>s)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,c.prototype),t}function c(e,t,n){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return h(e)}return u(e,t,n)}function u(e,t,n){if("string"==typeof e)return function(e,t){if("string"==typeof t&&""!==t||(t="utf8"),!c.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const n=0|m(e,t);let r=a(n);const i=r.write(e,t);return i!==n&&(r=r.slice(0,i)),r}(e,t);if(ArrayBuffer.isView(e))return function(e){if(J(e,Uint8Array)){const t=new Uint8Array(e);return f(t.buffer,t.byteOffset,t.byteLength)}return d(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(J(e,ArrayBuffer)||e&&J(e.buffer,ArrayBuffer))return f(e,t,n);if("undefined"!=typeof SharedArrayBuffer&&(J(e,SharedArrayBuffer)||e&&J(e.buffer,SharedArrayBuffer)))return f(e,t,n);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const r=e.valueOf&&e.valueOf();if(null!=r&&r!==e)return c.from(r,t,n);const i=function(e){if(c.isBuffer(e)){const t=0|p(e.length),n=a(t);return 0===n.length||e.copy(n,0,0,t),n}return void 0!==e.length?"number"!=typeof e.length||K(e.length)?a(0):d(e):"Buffer"===e.type&&Array.isArray(e.data)?d(e.data):void 0}(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return c.from(e[Symbol.toPrimitive]("string"),t,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function h(e){return l(e),a(e<0?0:0|p(e))}function d(e){const t=e.length<0?0:0|p(e.length),n=a(t);for(let r=0;r<t;r+=1)n[r]=255&e[r];return n}function f(e,t,n){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw new RangeError('"length" is outside of buffer bounds');let r;return r=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n),Object.setPrototypeOf(r,c.prototype),r}function p(e){if(e>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return 0|e}function m(e,t){if(c.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||J(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const n=e.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;let i=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return V(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return G(e).length;default:if(i)return r?-1:V(e).length;t=(""+t).toLowerCase(),i=!0}}function g(e,t,n){let r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return P(this,t,n);case"utf8":case"utf-8":return C(this,t,n);case"ascii":return k(this,t,n);case"latin1":case"binary":return I(this,t,n);case"base64":return R(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function y(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function b(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),K(n=+n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=c.from(t,r)),c.isBuffer(t))return 0===t.length?-1:v(e,t,n,r,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):v(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function v(e,t,n,r,i){let o,s=1,a=e.length,c=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;s=2,a/=2,c/=2,n/=2}function u(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(i){let r=-1;for(o=n;o<a;o++)if(u(e,o)===u(t,-1===r?0:o-r)){if(-1===r&&(r=o),o-r+1===c)return r*s}else-1!==r&&(o-=o-r),r=-1}else for(n+c>a&&(n=a-c),o=n;o>=0;o--){let n=!0;for(let r=0;r<c;r++)if(u(e,o+r)!==u(t,r)){n=!1;break}if(n)return o}return-1}function w(e,t,n,r){n=Number(n)||0;const i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;const o=t.length;let s;for(r>o/2&&(r=o/2),s=0;s<r;++s){const r=parseInt(t.substr(2*s,2),16);if(K(r))return s;e[n+s]=r}return s}function _(e,t,n,r){return Y(V(t,e.length-n),e,n,r)}function E(e,t,n,r){return Y(function(e){const t=[];for(let n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function S(e,t,n,r){return Y(G(t),e,n,r)}function T(e,t,n,r){return Y(function(e,t){let n,r,i;const o=[];for(let s=0;s<e.length&&!((t-=2)<0);++s)n=e.charCodeAt(s),r=n>>8,i=n%256,o.push(i),o.push(r);return o}(t,e.length-n),e,n,r)}function R(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function C(e,t,n){n=Math.min(e.length,n);const r=[];let i=t;for(;i<n;){const t=e[i];let o=null,s=t>239?4:t>223?3:t>191?2:1;if(i+s<=n){let n,r,a,c;switch(s){case 1:t<128&&(o=t);break;case 2:n=e[i+1],128==(192&n)&&(c=(31&t)<<6|63&n,c>127&&(o=c));break;case 3:n=e[i+1],r=e[i+2],128==(192&n)&&128==(192&r)&&(c=(15&t)<<12|(63&n)<<6|63&r,c>2047&&(c<55296||c>57343)&&(o=c));break;case 4:n=e[i+1],r=e[i+2],a=e[i+3],128==(192&n)&&128==(192&r)&&128==(192&a)&&(c=(15&t)<<18|(63&n)<<12|(63&r)<<6|63&a,c>65535&&c<1114112&&(o=c))}}null===o?(o=65533,s=1):o>65535&&(o-=65536,r.push(o>>>10&1023|55296),o=56320|1023&o),r.push(o),i+=s}return function(e){const t=e.length;if(t<=x)return String.fromCharCode.apply(String,e);let n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=x));return n}(r)}t.kMaxLength=s,c.TYPED_ARRAY_SUPPORT=function(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),c.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(c.prototype,"parent",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.buffer}}),Object.defineProperty(c.prototype,"offset",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.byteOffset}}),c.poolSize=8192,c.from=function(e,t,n){return u(e,t,n)},Object.setPrototypeOf(c.prototype,Uint8Array.prototype),Object.setPrototypeOf(c,Uint8Array),c.alloc=function(e,t,n){return function(e,t,n){return l(e),e<=0?a(e):void 0!==t?"string"==typeof n?a(e).fill(t,n):a(e).fill(t):a(e)}(e,t,n)},c.allocUnsafe=function(e){return h(e)},c.allocUnsafeSlow=function(e){return h(e)},c.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==c.prototype},c.compare=function(e,t){if(J(e,Uint8Array)&&(e=c.from(e,e.offset,e.byteLength)),J(t,Uint8Array)&&(t=c.from(t,t.offset,t.byteLength)),!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let n=e.length,r=t.length;for(let i=0,o=Math.min(n,r);i<o;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);let n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;const r=c.allocUnsafe(t);let i=0;for(n=0;n<e.length;++n){let t=e[n];if(J(t,Uint8Array))i+t.length>r.length?(c.isBuffer(t)||(t=c.from(t)),t.copy(r,i)):Uint8Array.prototype.set.call(r,t,i);else{if(!c.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(r,i)}i+=t.length}return r},c.byteLength=m,c.prototype._isBuffer=!0,c.prototype.swap16=function(){const e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)y(this,t,t+1);return this},c.prototype.swap32=function(){const e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)y(this,t,t+3),y(this,t+1,t+2);return this},c.prototype.swap64=function(){const e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)y(this,t,t+7),y(this,t+1,t+6),y(this,t+2,t+5),y(this,t+3,t+4);return this},c.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?C(this,0,e):g.apply(this,arguments)},c.prototype.toLocaleString=c.prototype.toString,c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===c.compare(this,e)},c.prototype.inspect=function(){let e="";const n=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(e+=" ... "),"<Buffer "+e+">"},o&&(c.prototype[o]=c.prototype.inspect),c.prototype.compare=function(e,t,n,r,i){if(J(e,Uint8Array)&&(e=c.from(e,e.offset,e.byteLength)),!c.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(this===e)return 0;let o=(i>>>=0)-(r>>>=0),s=(n>>>=0)-(t>>>=0);const a=Math.min(o,s),u=this.slice(r,i),l=e.slice(t,n);for(let e=0;e<a;++e)if(u[e]!==l[e]){o=u[e],s=l[e];break}return o<s?-1:s<o?1:0},c.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},c.prototype.indexOf=function(e,t,n){return b(this,e,t,n,!0)},c.prototype.lastIndexOf=function(e,t,n){return b(this,e,t,n,!1)},c.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}const i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");let o=!1;for(;;)switch(r){case"hex":return w(this,e,t,n);case"utf8":case"utf-8":return _(this,e,t,n);case"ascii":case"latin1":case"binary":return E(this,e,t,n);case"base64":return S(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const x=4096;function k(e,t,n){let r="";n=Math.min(e.length,n);for(let i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function I(e,t,n){let r="";n=Math.min(e.length,n);for(let i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function P(e,t,n){const r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);let i="";for(let r=t;r<n;++r)i+=X[e[r]];return i}function O(e,t,n){const r=e.slice(t,n);let i="";for(let e=0;e<r.length-1;e+=2)i+=String.fromCharCode(r[e]+256*r[e+1]);return i}function B(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function L(e,t,n,r,i,o){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function A(e,t,n,r,i){H(t,r,i,e,n,7);let o=Number(t&BigInt(4294967295));e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o;let s=Number(t>>BigInt(32)&BigInt(4294967295));return e[n++]=s,s>>=8,e[n++]=s,s>>=8,e[n++]=s,s>>=8,e[n++]=s,n}function M(e,t,n,r,i){H(t,r,i,e,n,7);let o=Number(t&BigInt(4294967295));e[n+7]=o,o>>=8,e[n+6]=o,o>>=8,e[n+5]=o,o>>=8,e[n+4]=o;let s=Number(t>>BigInt(32)&BigInt(4294967295));return e[n+3]=s,s>>=8,e[n+2]=s,s>>=8,e[n+1]=s,s>>=8,e[n]=s,n+8}function U(e,t,n,r,i,o){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function j(e,t,n,r,o){return t=+t,n>>>=0,o||U(e,0,n,4),i.write(e,t,n,r,23,4),n+4}function D(e,t,n,r,o){return t=+t,n>>>=0,o||U(e,0,n,8),i.write(e,t,n,r,52,8),n+8}c.prototype.slice=function(e,t){const n=this.length;(e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);const r=this.subarray(e,t);return Object.setPrototypeOf(r,c.prototype),r},c.prototype.readUintLE=c.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||B(e,t,this.length);let r=this[e],i=1,o=0;for(;++o<t&&(i*=256);)r+=this[e+o]*i;return r},c.prototype.readUintBE=c.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||B(e,t,this.length);let r=this[e+--t],i=1;for(;t>0&&(i*=256);)r+=this[e+--t]*i;return r},c.prototype.readUint8=c.prototype.readUInt8=function(e,t){return e>>>=0,t||B(e,1,this.length),this[e]},c.prototype.readUint16LE=c.prototype.readUInt16LE=function(e,t){return e>>>=0,t||B(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUint16BE=c.prototype.readUInt16BE=function(e,t){return e>>>=0,t||B(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUint32LE=c.prototype.readUInt32LE=function(e,t){return e>>>=0,t||B(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUint32BE=c.prototype.readUInt32BE=function(e,t){return e>>>=0,t||B(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readBigUInt64LE=Z((function(e){$(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||W(e,this.length-8);const r=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,i=this[++e]+256*this[++e]+65536*this[++e]+n*2**24;return BigInt(r)+(BigInt(i)<<BigInt(32))})),c.prototype.readBigUInt64BE=Z((function(e){$(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||W(e,this.length-8);const r=t*2**24+65536*this[++e]+256*this[++e]+this[++e],i=this[++e]*2**24+65536*this[++e]+256*this[++e]+n;return(BigInt(r)<<BigInt(32))+BigInt(i)})),c.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||B(e,t,this.length);let r=this[e],i=1,o=0;for(;++o<t&&(i*=256);)r+=this[e+o]*i;return i*=128,r>=i&&(r-=Math.pow(2,8*t)),r},c.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||B(e,t,this.length);let r=t,i=1,o=this[e+--r];for(;r>0&&(i*=256);)o+=this[e+--r]*i;return i*=128,o>=i&&(o-=Math.pow(2,8*t)),o},c.prototype.readInt8=function(e,t){return e>>>=0,t||B(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){e>>>=0,t||B(e,2,this.length);const n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt16BE=function(e,t){e>>>=0,t||B(e,2,this.length);const n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt32LE=function(e,t){return e>>>=0,t||B(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return e>>>=0,t||B(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readBigInt64LE=Z((function(e){$(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||W(e,this.length-8);const r=this[e+4]+256*this[e+5]+65536*this[e+6]+(n<<24);return(BigInt(r)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)})),c.prototype.readBigInt64BE=Z((function(e){$(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||W(e,this.length-8);const r=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(r)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+n)})),c.prototype.readFloatLE=function(e,t){return e>>>=0,t||B(e,4,this.length),i.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return e>>>=0,t||B(e,4,this.length),i.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return e>>>=0,t||B(e,8,this.length),i.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return e>>>=0,t||B(e,8,this.length),i.read(this,e,!1,52,8)},c.prototype.writeUintLE=c.prototype.writeUIntLE=function(e,t,n,r){e=+e,t>>>=0,n>>>=0,r||L(this,e,t,n,Math.pow(2,8*n)-1,0);let i=1,o=0;for(this[t]=255&e;++o<n&&(i*=256);)this[t+o]=e/i&255;return t+n},c.prototype.writeUintBE=c.prototype.writeUIntBE=function(e,t,n,r){e=+e,t>>>=0,n>>>=0,r||L(this,e,t,n,Math.pow(2,8*n)-1,0);let i=n-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+n},c.prototype.writeUint8=c.prototype.writeUInt8=function(e,t,n){return e=+e,t>>>=0,n||L(this,e,t,1,255,0),this[t]=255&e,t+1},c.prototype.writeUint16LE=c.prototype.writeUInt16LE=function(e,t,n){return e=+e,t>>>=0,n||L(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},c.prototype.writeUint16BE=c.prototype.writeUInt16BE=function(e,t,n){return e=+e,t>>>=0,n||L(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},c.prototype.writeUint32LE=c.prototype.writeUInt32LE=function(e,t,n){return e=+e,t>>>=0,n||L(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},c.prototype.writeUint32BE=c.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||L(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},c.prototype.writeBigUInt64LE=Z((function(e,t=0){return A(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),c.prototype.writeBigUInt64BE=Z((function(e,t=0){return M(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),c.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t>>>=0,!r){const r=Math.pow(2,8*n-1);L(this,e,t,n,r-1,-r)}let i=0,o=1,s=0;for(this[t]=255&e;++i<n&&(o*=256);)e<0&&0===s&&0!==this[t+i-1]&&(s=1),this[t+i]=(e/o>>0)-s&255;return t+n},c.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t>>>=0,!r){const r=Math.pow(2,8*n-1);L(this,e,t,n,r-1,-r)}let i=n-1,o=1,s=0;for(this[t+i]=255&e;--i>=0&&(o*=256);)e<0&&0===s&&0!==this[t+i+1]&&(s=1),this[t+i]=(e/o>>0)-s&255;return t+n},c.prototype.writeInt8=function(e,t,n){return e=+e,t>>>=0,n||L(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},c.prototype.writeInt16LE=function(e,t,n){return e=+e,t>>>=0,n||L(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},c.prototype.writeInt16BE=function(e,t,n){return e=+e,t>>>=0,n||L(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},c.prototype.writeInt32LE=function(e,t,n){return e=+e,t>>>=0,n||L(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},c.prototype.writeInt32BE=function(e,t,n){return e=+e,t>>>=0,n||L(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},c.prototype.writeBigInt64LE=Z((function(e,t=0){return A(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),c.prototype.writeBigInt64BE=Z((function(e,t=0){return M(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),c.prototype.writeFloatLE=function(e,t,n){return j(this,e,t,!0,n)},c.prototype.writeFloatBE=function(e,t,n){return j(this,e,t,!1,n)},c.prototype.writeDoubleLE=function(e,t,n){return D(this,e,t,!0,n)},c.prototype.writeDoubleBE=function(e,t,n){return D(this,e,t,!1,n)},c.prototype.copy=function(e,t,n,r){if(!c.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);const i=r-n;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,n,r):Uint8Array.prototype.set.call(e,this.subarray(n,r),t),i},c.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!c.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===e.length){const t=e.charCodeAt(0);("utf8"===r&&t<128||"latin1"===r)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;let i;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(i=t;i<n;++i)this[i]=e;else{const o=c.isBuffer(e)?e:c.from(e,r),s=o.length;if(0===s)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<n-t;++i)this[i+t]=o[i%s]}return this};const N={};function F(e,t,n){N[e]=class extends n{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function q(e){let t="",n=e.length;const r="-"===e[0]?1:0;for(;n>=r+4;n-=3)t=`_${e.slice(n-3,n)}${t}`;return`${e.slice(0,n)}${t}`}function H(e,t,n,r,i,o){if(e>n||e<t){const r="bigint"==typeof t?"n":"";let i;throw i=o>3?0===t||t===BigInt(0)?`>= 0${r} and < 2${r} ** ${8*(o+1)}${r}`:`>= -(2${r} ** ${8*(o+1)-1}${r}) and < 2 ** ${8*(o+1)-1}${r}`:`>= ${t}${r} and <= ${n}${r}`,new N.ERR_OUT_OF_RANGE("value",i,e)}!function(e,t,n){$(t,"offset"),void 0!==e[t]&&void 0!==e[t+n]||W(t,e.length-(n+1))}(r,i,o)}function $(e,t){if("number"!=typeof e)throw new N.ERR_INVALID_ARG_TYPE(t,"number",e)}function W(e,t,n){if(Math.floor(e)!==e)throw $(e,n),new N.ERR_OUT_OF_RANGE(n||"offset","an integer",e);if(t<0)throw new N.ERR_BUFFER_OUT_OF_BOUNDS;throw new N.ERR_OUT_OF_RANGE(n||"offset",`>= ${n?1:0} and <= ${t}`,e)}F("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),F("ERR_INVALID_ARG_TYPE",(function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`}),TypeError),F("ERR_OUT_OF_RANGE",(function(e,t,n){let r=`The value of "${e}" is out of range.`,i=n;return Number.isInteger(n)&&Math.abs(n)>2**32?i=q(String(n)):"bigint"==typeof n&&(i=String(n),(n>BigInt(2)**BigInt(32)||n<-(BigInt(2)**BigInt(32)))&&(i=q(i)),i+="n"),r+=` It must be ${t}. Received ${i}`,r}),RangeError);const z=/[^+/0-9A-Za-z-_]/g;function V(e,t){let n;t=t||1/0;const r=e.length;let i=null;const o=[];for(let s=0;s<r;++s){if(n=e.charCodeAt(s),n>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(s+1===r){(t-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function G(e){return r.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(z,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function Y(e,t,n,r){let i;for(i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}function J(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function K(e){return e!=e}const X=function(){const e="0123456789abcdef",t=new Array(256);for(let n=0;n<16;++n){const r=16*n;for(let i=0;i<16;++i)t[r+i]=e[n]+e[i]}return t}();function Z(e){return"undefined"==typeof BigInt?Q:e}function Q(){throw new Error("BigInt not supported")}},227:(e,t,n)=>{var r=n(155);t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;t.splice(1,0,n,"color: inherit");let r=0,i=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(r++,"%c"===e&&(i=r))})),t.splice(i,0,n)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}return!e&&void 0!==r&&"env"in r&&(e=r.env.DEBUG),e},t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=n(447)(t);const{formatters:i}=e.exports;i.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},447:(e,t,n)=>{e.exports=function(e){function t(e){let n,i,o,s=null;function a(...e){if(!a.enabled)return;const r=a,i=Number(new Date),o=i-(n||i);r.diff=o,r.prev=n,r.curr=i,n=i,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let s=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((n,i)=>{if("%%"===n)return"%";s++;const o=t.formatters[i];if("function"==typeof o){const t=e[s];n=o.call(r,t),e.splice(s,1),s--}return n})),t.formatArgs.call(r,e),(r.log||t.log).apply(r,e)}return a.namespace=e,a.useColors=t.useColors(),a.color=t.selectColor(e),a.extend=r,a.destroy=t.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==s?s:(i!==t.namespaces&&(i=t.namespaces,o=t.enabled(e)),o),set:e=>{s=e}}),"function"==typeof t.init&&t.init(a),a}function r(e,n){const r=t(this.namespace+(void 0===n?":":n)+e);return r.log=this.log,r}function i(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){const e=[...t.names.map(i),...t.skips.map(i).map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){let n;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const r=("string"==typeof e?e:"").split(/[\s,]+/),i=r.length;for(n=0;n<i;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(824),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((n=>{t[n]=e[n]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let n=0;for(let t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return t.colors[Math.abs(n)%t.colors.length]},t.enable(t.load()),t}},187:e=>{"use strict";var t,n="object"==typeof Reflect?Reflect:null,r=n&&"function"==typeof n.apply?n.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};t=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var i=Number.isNaN||function(e){return e!=e};function o(){o.init.call(this)}e.exports=o,e.exports.once=function(e,t){return new Promise((function(n,r){function i(n){e.removeListener(t,o),r(n)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",i),n([].slice.call(arguments))}m(e,t,o,{once:!0}),"error"!==t&&function(e,t,n){"function"==typeof e.on&&m(e,"error",t,{once:!0})}(e,i)}))},o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var s=10;function a(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function c(e){return void 0===e._maxListeners?o.defaultMaxListeners:e._maxListeners}function u(e,t,n,r){var i,o,s,u;if(a(n),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),s=o[t]),void 0===s)s=o[t]=n,++e._eventsCount;else if("function"==typeof s?s=o[t]=r?[n,s]:[s,n]:r?s.unshift(n):s.push(n),(i=c(e))>0&&s.length>i&&!s.warned){s.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=s.length,u=l,console&&console.warn&&console.warn(u)}return e}function l(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function h(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=l.bind(r);return i.listener=n,r.wrapFn=i,i}function d(e,t,n){var r=e._events;if(void 0===r)return[];var i=r[t];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(i):p(i,i.length)}function f(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function p(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function m(e,t,n,r){if("function"==typeof e.on)r.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function i(o){r.once&&e.removeEventListener(t,i),n(o)}))}}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");s=e}}),o.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},o.prototype.getMaxListeners=function(){return c(this)},o.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i="error"===e,o=this._events;if(void 0!==o)i=i&&void 0===o.error;else if(!i)return!1;if(i){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var c=o[e];if(void 0===c)return!1;if("function"==typeof c)r(c,this,t);else{var u=c.length,l=p(c,u);for(n=0;n<u;++n)r(l[n],this,t)}return!0},o.prototype.addListener=function(e,t){return u(this,e,t,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(e,t){return u(this,e,t,!0)},o.prototype.once=function(e,t){return a(t),this.on(e,h(this,e,t)),this},o.prototype.prependOnceListener=function(e,t){return a(t),this.prependListener(e,h(this,e,t)),this},o.prototype.removeListener=function(e,t){var n,r,i,o,s;if(a(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===t||n[o].listener===t){s=n[o].listener,i=o;break}if(i<0)return this;0===i?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,s||t)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var i,o=Object.keys(n);for(r=0;r<o.length;++r)"removeListener"!==(i=o[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},o.prototype.listeners=function(e){return d(this,e,!0)},o.prototype.rawListeners=function(e){return d(this,e,!1)},o.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):f.call(e,t)},o.prototype.listenerCount=f,o.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},645:(e,t)=>{t.read=function(e,t,n,r,i){var o,s,a=8*i-r-1,c=(1<<a)-1,u=c>>1,l=-7,h=n?i-1:0,d=n?-1:1,f=e[t+h];for(h+=d,o=f&(1<<-l)-1,f>>=-l,l+=a;l>0;o=256*o+e[t+h],h+=d,l-=8);for(s=o&(1<<-l)-1,o>>=-l,l+=r;l>0;s=256*s+e[t+h],h+=d,l-=8);if(0===o)o=1-u;else{if(o===c)return s?NaN:1/0*(f?-1:1);s+=Math.pow(2,r),o-=u}return(f?-1:1)*s*Math.pow(2,o-r)},t.write=function(e,t,n,r,i,o){var s,a,c,u=8*o-i-1,l=(1<<u)-1,h=l>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:o-1,p=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=l):(s=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-s))<1&&(s--,c*=2),(t+=s+h>=1?d/c:d*Math.pow(2,1-h))*c>=2&&(s++,c/=2),s+h>=l?(a=0,s=l):s+h>=1?(a=(t*c-1)*Math.pow(2,i),s+=h):(a=t*Math.pow(2,h-1)*Math.pow(2,i),s=0));i>=8;e[n+f]=255&a,f+=p,a/=256,i-=8);for(s=s<<i|a,u+=i;u>0;e[n+f]=255&s,f+=p,s/=256,u-=8);e[n+f-p]|=128*m}},717:e=>{"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}},824:e=>{var t=1e3,n=60*t,r=60*n,i=24*r;function o(e,t,n,r){var i=t>=1.5*n;return Math.round(e/n)+" "+r+(i?"s":"")}e.exports=function(e,s){s=s||{};var a,c,u=typeof e;if("string"===u&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var o=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(o){var s=parseFloat(o[1]);switch((o[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*s;case"weeks":case"week":case"w":return 6048e5*s;case"days":case"day":case"d":return s*i;case"hours":case"hour":case"hrs":case"hr":case"h":return s*r;case"minutes":case"minute":case"mins":case"min":case"m":return s*n;case"seconds":case"second":case"secs":case"sec":case"s":return s*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}}}(e);if("number"===u&&isFinite(e))return s.long?(a=e,(c=Math.abs(a))>=i?o(a,c,i,"day"):c>=r?o(a,c,r,"hour"):c>=n?o(a,c,n,"minute"):c>=t?o(a,c,t,"second"):a+" ms"):function(e){var o=Math.abs(e);return o>=i?Math.round(e/i)+"d":o>=r?Math.round(e/r)+"h":o>=n?Math.round(e/n)+"m":o>=t?Math.round(e/t)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},155:e=>{var t,n,r=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(e){if(t===setTimeout)return setTimeout(e,0);if((t===i||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:i}catch(e){t=i}try{n="function"==typeof clearTimeout?clearTimeout:o}catch(e){n=o}}();var a,c=[],u=!1,l=-1;function h(){u&&a&&(u=!1,a.length?c=a.concat(c):l=-1,c.length&&d())}function d(){if(!u){var e=s(h);u=!0;for(var t=c.length;t;){for(a=c,c=[];++l<t;)a&&a[l].run();l=-1,t=c.length}a=null,u=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function p(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new f(e,t)),1!==c.length||u||s(d)},f.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=p,r.addListener=p,r.once=p,r.off=p,r.removeListener=p,r.removeAllListeners=p,r.emit=p,r.prependListener=p,r.prependOnceListener=p,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},281:e=>{"use strict";var t={};function n(e,n,r){r||(r=Error);var i=function(e){var t,r;function i(t,r,i){return e.call(this,function(e,t,r){return"string"==typeof n?n:n(e,t,r)}(t,r,i))||this}return r=e,(t=i).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,i}(r);i.prototype.name=r.name,i.prototype.code=e,t[e]=i}function r(e,t){if(Array.isArray(e)){var n=e.length;return e=e.map((function(e){return String(e)})),n>2?"one of ".concat(t," ").concat(e.slice(0,n-1).join(", "),", or ")+e[n-1]:2===n?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])}return"of ".concat(t," ").concat(String(e))}n("ERR_INVALID_OPT_VALUE",(function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'}),TypeError),n("ERR_INVALID_ARG_TYPE",(function(e,t,n){var i,o,s,a,c;if("string"==typeof t&&(o="not ",t.substr(0,o.length)===o)?(i="must not be",t=t.replace(/^not /,"")):i="must be",function(e,t,n){return(void 0===n||n>e.length)&&(n=e.length),e.substring(n-t.length,n)===t}(e," argument"))s="The ".concat(e," ").concat(i," ").concat(r(t,"type"));else{var u=("number"!=typeof c&&(c=0),c+".".length>(a=e).length||-1===a.indexOf(".",c)?"argument":"property");s='The "'.concat(e,'" ').concat(u," ").concat(i," ").concat(r(t,"type"))}return s+". Received type ".concat(typeof n)}),TypeError),n("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),n("ERR_METHOD_NOT_IMPLEMENTED",(function(e){return"The "+e+" method is not implemented"})),n("ERR_STREAM_PREMATURE_CLOSE","Premature close"),n("ERR_STREAM_DESTROYED",(function(e){return"Cannot call "+e+" after a stream was destroyed"})),n("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),n("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),n("ERR_STREAM_WRITE_AFTER_END","write after end"),n("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),n("ERR_UNKNOWN_ENCODING",(function(e){return"Unknown encoding: "+e}),TypeError),n("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),e.exports.q=t},753:(e,t,n)=>{"use strict";var r=n(155),i=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t};e.exports=l;var o=n(481),s=n(229);n(717)(l,o);for(var a=i(s.prototype),c=0;c<a.length;c++){var u=a[c];l.prototype[u]||(l.prototype[u]=s.prototype[u])}function l(e){if(!(this instanceof l))return new l(e);o.call(this,e),s.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",h)))}function h(){this._writableState.ended||r.nextTick(d,this)}function d(e){e.end()}Object.defineProperty(l.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(l.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(l.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(l.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}})},725:(e,t,n)=>{"use strict";e.exports=i;var r=n(605);function i(e){if(!(this instanceof i))return new i(e);r.call(this,e)}n(717)(i,r),i.prototype._transform=function(e,t,n){n(null,e)}},481:(e,t,n)=>{"use strict";var r,i=n(155);e.exports=R,R.ReadableState=T,n(187).EventEmitter;var o,s=function(e,t){return e.listeners(t).length},a=n(503),c=n(764).Buffer,u=n.g.Uint8Array||function(){},l=n(616);o=l&&l.debuglog?l.debuglog("stream"):function(){};var h,d,f,p=n(327),m=n(195),g=n(457).getHighWaterMark,y=n(281).q,b=y.ERR_INVALID_ARG_TYPE,v=y.ERR_STREAM_PUSH_AFTER_EOF,w=y.ERR_METHOD_NOT_IMPLEMENTED,_=y.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;n(717)(R,a);var E=m.errorOrDestroy,S=["error","close","destroy","pause","resume"];function T(e,t,i){r=r||n(753),e=e||{},"boolean"!=typeof i&&(i=t instanceof r),this.objectMode=!!e.objectMode,i&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.highWaterMark=g(this,e,"readableHighWaterMark",i),this.buffer=new p,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(h||(h=n(553).s),this.decoder=new h(e.encoding),this.encoding=e.encoding)}function R(e){if(r=r||n(753),!(this instanceof R))return new R(e);var t=this instanceof r;this._readableState=new T(e,this,t),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),a.call(this)}function C(e,t,n,r,i){o("readableAddChunk",t);var s,a=e._readableState;if(null===t)a.reading=!1,function(e,t){if(o("onEofChunk"),!t.ended){if(t.decoder){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,t.sync?P(e):(t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,O(e)))}}(e,a);else if(i||(s=function(e,t){var n,r;return r=t,c.isBuffer(r)||r instanceof u||"string"==typeof t||void 0===t||e.objectMode||(n=new b("chunk",["string","Buffer","Uint8Array"],t)),n}(a,t)),s)E(e,s);else if(a.objectMode||t&&t.length>0)if("string"==typeof t||a.objectMode||Object.getPrototypeOf(t)===c.prototype||(t=function(e){return c.from(e)}(t)),r)a.endEmitted?E(e,new _):x(e,a,t,!0);else if(a.ended)E(e,new v);else{if(a.destroyed)return!1;a.reading=!1,a.decoder&&!n?(t=a.decoder.write(t),a.objectMode||0!==t.length?x(e,a,t,!1):B(e,a)):x(e,a,t,!1)}else r||(a.reading=!1,B(e,a));return!a.ended&&(a.length<a.highWaterMark||0===a.length)}function x(e,t,n,r){t.flowing&&0===t.length&&!t.sync?(t.awaitDrain=0,e.emit("data",n)):(t.length+=t.objectMode?1:n.length,r?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&P(e)),B(e,t)}Object.defineProperty(R.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),R.prototype.destroy=m.destroy,R.prototype._undestroy=m.undestroy,R.prototype._destroy=function(e,t){t(e)},R.prototype.push=function(e,t){var n,r=this._readableState;return r.objectMode?n=!0:"string"==typeof e&&((t=t||r.defaultEncoding)!==r.encoding&&(e=c.from(e,t),t=""),n=!0),C(this,e,t,!1,n)},R.prototype.unshift=function(e){return C(this,e,null,!0,!1)},R.prototype.isPaused=function(){return!1===this._readableState.flowing},R.prototype.setEncoding=function(e){h||(h=n(553).s);var t=new h(e);this._readableState.decoder=t,this._readableState.encoding=this._readableState.decoder.encoding;for(var r=this._readableState.buffer.head,i="";null!==r;)i+=t.write(r.data),r=r.next;return this._readableState.buffer.clear(),""!==i&&this._readableState.buffer.push(i),this._readableState.length=i.length,this};var k=1073741824;function I(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=k?e=k:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function P(e){var t=e._readableState;o("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(o("emitReadable",t.flowing),t.emittedReadable=!0,i.nextTick(O,e))}function O(e){var t=e._readableState;o("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,j(e)}function B(e,t){t.readingMore||(t.readingMore=!0,i.nextTick(L,e,t))}function L(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){var n=t.length;if(o("maybeReadMore read 0"),e.read(0),n===t.length)break}t.readingMore=!1}function A(e){var t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!t.paused?t.flowing=!0:e.listenerCount("data")>0&&e.resume()}function M(e){o("readable nexttick read 0"),e.read(0)}function U(e,t){o("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),j(e),t.flowing&&!t.reading&&e.read(0)}function j(e){var t=e._readableState;for(o("flow",t.flowing);t.flowing&&null!==e.read(););}function D(e,t){return 0===t.length?null:(t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):n=t.buffer.consume(e,t.decoder),n);var n}function N(e){var t=e._readableState;o("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,i.nextTick(F,t,e))}function F(e,t){if(o("endReadableNT",e.endEmitted,e.length),!e.endEmitted&&0===e.length&&(e.endEmitted=!0,t.readable=!1,t.emit("end"),e.autoDestroy)){var n=t._writableState;(!n||n.autoDestroy&&n.finished)&&t.destroy()}}function q(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}R.prototype.read=function(e){o("read",e),e=parseInt(e,10);var t=this._readableState,n=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return o("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?N(this):P(this),null;if(0===(e=I(e,t))&&t.ended)return 0===t.length&&N(this),null;var r,i=t.needReadable;return o("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&o("length less than watermark",i=!0),t.ended||t.reading?o("reading or ended",i=!1):i&&(o("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=I(n,t))),null===(r=e>0?D(e,t):null)?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.awaitDrain=0),0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&N(this)),null!==r&&this.emit("data",r),r},R.prototype._read=function(e){E(this,new w("_read()"))},R.prototype.pipe=function(e,t){var n=this,r=this._readableState;switch(r.pipesCount){case 0:r.pipes=e;break;case 1:r.pipes=[r.pipes,e];break;default:r.pipes.push(e)}r.pipesCount+=1,o("pipe count=%d opts=%j",r.pipesCount,t);var a=t&&!1===t.end||e===i.stdout||e===i.stderr?m:c;function c(){o("onend"),e.end()}r.endEmitted?i.nextTick(a):n.once("end",a),e.on("unpipe",(function t(i,s){o("onunpipe"),i===n&&s&&!1===s.hasUnpiped&&(s.hasUnpiped=!0,o("cleanup"),e.removeListener("close",f),e.removeListener("finish",p),e.removeListener("drain",u),e.removeListener("error",d),e.removeListener("unpipe",t),n.removeListener("end",c),n.removeListener("end",m),n.removeListener("data",h),l=!0,!r.awaitDrain||e._writableState&&!e._writableState.needDrain||u())}));var u=function(e){return function(){var t=e._readableState;o("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&s(e,"data")&&(t.flowing=!0,j(e))}}(n);e.on("drain",u);var l=!1;function h(t){o("ondata");var i=e.write(t);o("dest.write",i),!1===i&&((1===r.pipesCount&&r.pipes===e||r.pipesCount>1&&-1!==q(r.pipes,e))&&!l&&(o("false write response, pause",r.awaitDrain),r.awaitDrain++),n.pause())}function d(t){o("onerror",t),m(),e.removeListener("error",d),0===s(e,"error")&&E(e,t)}function f(){e.removeListener("finish",p),m()}function p(){o("onfinish"),e.removeListener("close",f),m()}function m(){o("unpipe"),n.unpipe(e)}return n.on("data",h),function(e,t,n){if("function"==typeof e.prependListener)return e.prependListener(t,n);e._events&&e._events.error?Array.isArray(e._events.error)?e._events.error.unshift(n):e._events.error=[n,e._events.error]:e.on(t,n)}(e,"error",d),e.once("close",f),e.once("finish",p),e.emit("pipe",n),r.flowing||(o("pipe resume"),n.resume()),e},R.prototype.unpipe=function(e){var t=this._readableState,n={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,n)),this;if(!e){var r=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var o=0;o<i;o++)r[o].emit("unpipe",this,{hasUnpiped:!1});return this}var s=q(t.pipes,e);return-1===s||(t.pipes.splice(s,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,n)),this},R.prototype.on=function(e,t){var n=a.prototype.on.call(this,e,t),r=this._readableState;return"data"===e?(r.readableListening=this.listenerCount("readable")>0,!1!==r.flowing&&this.resume()):"readable"===e&&(r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.flowing=!1,r.emittedReadable=!1,o("on readable",r.length,r.reading),r.length?P(this):r.reading||i.nextTick(M,this))),n},R.prototype.addListener=R.prototype.on,R.prototype.removeListener=function(e,t){var n=a.prototype.removeListener.call(this,e,t);return"readable"===e&&i.nextTick(A,this),n},R.prototype.removeAllListeners=function(e){var t=a.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&void 0!==e||i.nextTick(A,this),t},R.prototype.resume=function(){var e=this._readableState;return e.flowing||(o("resume"),e.flowing=!e.readableListening,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,i.nextTick(U,e,t))}(this,e)),e.paused=!1,this},R.prototype.pause=function(){return o("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(o("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},R.prototype.wrap=function(e){var t=this,n=this._readableState,r=!1;for(var i in e.on("end",(function(){if(o("wrapped end"),n.decoder&&!n.ended){var e=n.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(i){o("wrapped data"),n.decoder&&(i=n.decoder.write(i)),n.objectMode&&null==i||(n.objectMode||i&&i.length)&&(t.push(i)||(r=!0,e.pause()))})),e)void 0===this[i]&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var s=0;s<S.length;s++)e.on(S[s],this.emit.bind(this,S[s]));return this._read=function(t){o("wrapped _read",t),r&&(r=!1,e.resume())},this},"function"==typeof Symbol&&(R.prototype[Symbol.asyncIterator]=function(){return void 0===d&&(d=n(850)),d(this)}),Object.defineProperty(R.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(R.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(R.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),R._fromList=D,Object.defineProperty(R.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(R.from=function(e,t){return void 0===f&&(f=n(167)),f(R,e,t)})},605:(e,t,n)=>{"use strict";e.exports=l;var r=n(281).q,i=r.ERR_METHOD_NOT_IMPLEMENTED,o=r.ERR_MULTIPLE_CALLBACK,s=r.ERR_TRANSFORM_ALREADY_TRANSFORMING,a=r.ERR_TRANSFORM_WITH_LENGTH_0,c=n(753);function u(e,t){var n=this._transformState;n.transforming=!1;var r=n.writecb;if(null===r)return this.emit("error",new o);n.writechunk=null,n.writecb=null,null!=t&&this.push(t),r(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function l(e){if(!(this instanceof l))return new l(e);c.call(this,e),this._transformState={afterTransform:u.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",h)}function h(){var e=this;"function"!=typeof this._flush||this._readableState.destroyed?d(this,null,null):this._flush((function(t,n){d(e,t,n)}))}function d(e,t,n){if(t)return e.emit("error",t);if(null!=n&&e.push(n),e._writableState.length)throw new a;if(e._transformState.transforming)throw new s;return e.push(null)}n(717)(l,c),l.prototype.push=function(e,t){return this._transformState.needTransform=!1,c.prototype.push.call(this,e,t)},l.prototype._transform=function(e,t,n){n(new i("_transform()"))},l.prototype._write=function(e,t,n){var r=this._transformState;if(r.writecb=n,r.writechunk=e,r.writeencoding=t,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},l.prototype._read=function(e){var t=this._transformState;null===t.writechunk||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))},l.prototype._destroy=function(e,t){c.prototype._destroy.call(this,e,(function(e){t(e)}))}},229:(e,t,n)=>{"use strict";var r,i=n(155);function o(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,n){var r=e.entry;for(e.entry=null;r;){var i=r.callback;t.pendingcb--,i(undefined),r=r.next}t.corkedRequestsFree.next=e}(t,e)}}e.exports=R,R.WritableState=T;var s,a={deprecate:n(927)},c=n(503),u=n(764).Buffer,l=n.g.Uint8Array||function(){},h=n(195),d=n(457).getHighWaterMark,f=n(281).q,p=f.ERR_INVALID_ARG_TYPE,m=f.ERR_METHOD_NOT_IMPLEMENTED,g=f.ERR_MULTIPLE_CALLBACK,y=f.ERR_STREAM_CANNOT_PIPE,b=f.ERR_STREAM_DESTROYED,v=f.ERR_STREAM_NULL_VALUES,w=f.ERR_STREAM_WRITE_AFTER_END,_=f.ERR_UNKNOWN_ENCODING,E=h.errorOrDestroy;function S(){}function T(e,t,s){r=r||n(753),e=e||{},"boolean"!=typeof s&&(s=t instanceof r),this.objectMode=!!e.objectMode,s&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=d(this,e,"writableHighWaterMark",s),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var a=!1===e.decodeStrings;this.decodeStrings=!a,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var n=e._writableState,r=n.sync,o=n.writecb;if("function"!=typeof o)throw new g;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(n),t)!function(e,t,n,r,o){--t.pendingcb,n?(i.nextTick(o,r),i.nextTick(O,e,t),e._writableState.errorEmitted=!0,E(e,r)):(o(r),e._writableState.errorEmitted=!0,E(e,r),O(e,t))}(e,n,r,t,o);else{var s=I(n)||e.destroyed;s||n.corked||n.bufferProcessing||!n.bufferedRequest||k(e,n),r?i.nextTick(x,e,n,s,o):x(e,n,s,o)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new o(this)}function R(e){var t=this instanceof(r=r||n(753));if(!t&&!s.call(R,this))return new R(e);this._writableState=new T(e,this,t),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),c.call(this)}function C(e,t,n,r,i,o,s){t.writelen=r,t.writecb=s,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new b("write")):n?e._writev(i,t.onwrite):e._write(i,o,t.onwrite),t.sync=!1}function x(e,t,n,r){n||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,r(),O(e,t)}function k(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var r=t.bufferedRequestCount,i=new Array(r),s=t.corkedRequestsFree;s.entry=n;for(var a=0,c=!0;n;)i[a]=n,n.isBuf||(c=!1),n=n.next,a+=1;i.allBuffers=c,C(e,t,!0,t.length,i,"",s.finish),t.pendingcb++,t.lastBufferedRequest=null,s.next?(t.corkedRequestsFree=s.next,s.next=null):t.corkedRequestsFree=new o(t),t.bufferedRequestCount=0}else{for(;n;){var u=n.chunk,l=n.encoding,h=n.callback;if(C(e,t,!1,t.objectMode?1:u.length,u,l,h),n=n.next,t.bufferedRequestCount--,t.writing)break}null===n&&(t.lastBufferedRequest=null)}t.bufferedRequest=n,t.bufferProcessing=!1}function I(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function P(e,t){e._final((function(n){t.pendingcb--,n&&E(e,n),t.prefinished=!0,e.emit("prefinish"),O(e,t)}))}function O(e,t){var n=I(t);if(n&&(function(e,t){t.prefinished||t.finalCalled||("function"!=typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.pendingcb++,t.finalCalled=!0,i.nextTick(P,e,t)))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"),t.autoDestroy))){var r=e._readableState;(!r||r.autoDestroy&&r.endEmitted)&&e.destroy()}return n}n(717)(R,c),T.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(T.prototype,"buffer",{get:a.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(s=Function.prototype[Symbol.hasInstance],Object.defineProperty(R,Symbol.hasInstance,{value:function(e){return!!s.call(this,e)||this===R&&e&&e._writableState instanceof T}})):s=function(e){return e instanceof this},R.prototype.pipe=function(){E(this,new y)},R.prototype.write=function(e,t,n){var r,o=this._writableState,s=!1,a=!o.objectMode&&(r=e,u.isBuffer(r)||r instanceof l);return a&&!u.isBuffer(e)&&(e=function(e){return u.from(e)}(e)),"function"==typeof t&&(n=t,t=null),a?t="buffer":t||(t=o.defaultEncoding),"function"!=typeof n&&(n=S),o.ending?function(e,t){var n=new w;E(e,n),i.nextTick(t,n)}(this,n):(a||function(e,t,n,r){var o;return null===n?o=new v:"string"==typeof n||t.objectMode||(o=new p("chunk",["string","Buffer"],n)),!o||(E(e,o),i.nextTick(r,o),!1)}(this,o,e,n))&&(o.pendingcb++,s=function(e,t,n,r,i,o){if(!n){var s=function(e,t,n){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=u.from(t,n)),t}(t,r,i);r!==s&&(n=!0,i="buffer",r=s)}var a=t.objectMode?1:r.length;t.length+=a;var c=t.length<t.highWaterMark;if(c||(t.needDrain=!0),t.writing||t.corked){var l=t.lastBufferedRequest;t.lastBufferedRequest={chunk:r,encoding:i,isBuf:n,callback:o,next:null},l?l.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else C(e,t,!1,a,r,i,o);return c}(this,o,a,e,t,n)),s},R.prototype.cork=function(){this._writableState.corked++},R.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||k(this,e))},R.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new _(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(R.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(R.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),R.prototype._write=function(e,t,n){n(new m("_write()"))},R.prototype._writev=null,R.prototype.end=function(e,t,n){var r=this._writableState;return"function"==typeof e?(n=e,e=null,t=null):"function"==typeof t&&(n=t,t=null),null!=e&&this.write(e,t),r.corked&&(r.corked=1,this.uncork()),r.ending||function(e,t,n){t.ending=!0,O(e,t),n&&(t.finished?i.nextTick(n):e.once("finish",n)),t.ended=!0,e.writable=!1}(this,r,n),this},Object.defineProperty(R.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(R.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),R.prototype.destroy=h.destroy,R.prototype._undestroy=h.undestroy,R.prototype._destroy=function(e,t){t(e)}},850:(e,t,n)=>{"use strict";var r,i=n(155);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var s=n(610),a=Symbol("lastResolve"),c=Symbol("lastReject"),u=Symbol("error"),l=Symbol("ended"),h=Symbol("lastPromise"),d=Symbol("handlePromise"),f=Symbol("stream");function p(e,t){return{value:e,done:t}}function m(e){var t=e[a];if(null!==t){var n=e[f].read();null!==n&&(e[h]=null,e[a]=null,e[c]=null,t(p(n,!1)))}}function g(e){i.nextTick(m,e)}var y=Object.getPrototypeOf((function(){})),b=Object.setPrototypeOf((o(r={get stream(){return this[f]},next:function(){var e=this,t=this[u];if(null!==t)return Promise.reject(t);if(this[l])return Promise.resolve(p(void 0,!0));if(this[f].destroyed)return new Promise((function(t,n){i.nextTick((function(){e[u]?n(e[u]):t(p(void 0,!0))}))}));var n,r=this[h];if(r)n=new Promise(function(e,t){return function(n,r){e.then((function(){t[l]?n(p(void 0,!0)):t[d](n,r)}),r)}}(r,this));else{var o=this[f].read();if(null!==o)return Promise.resolve(p(o,!1));n=new Promise(this[d])}return this[h]=n,n}},Symbol.asyncIterator,(function(){return this})),o(r,"return",(function(){var e=this;return new Promise((function(t,n){e[f].destroy(null,(function(e){e?n(e):t(p(void 0,!0))}))}))})),r),y);e.exports=function(e){var t,n=Object.create(b,(o(t={},f,{value:e,writable:!0}),o(t,a,{value:null,writable:!0}),o(t,c,{value:null,writable:!0}),o(t,u,{value:null,writable:!0}),o(t,l,{value:e._readableState.endEmitted,writable:!0}),o(t,d,{value:function(e,t){var r=n[f].read();r?(n[h]=null,n[a]=null,n[c]=null,e(p(r,!1))):(n[a]=e,n[c]=t)},writable:!0}),t));return n[h]=null,s(e,(function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){var t=n[c];return null!==t&&(n[h]=null,n[a]=null,n[c]=null,t(e)),void(n[u]=e)}var r=n[a];null!==r&&(n[h]=null,n[a]=null,n[c]=null,r(p(void 0,!0))),n[l]=!0})),e.on("readable",g.bind(null,n)),n}},327:(e,t,n)=>{"use strict";function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var s=n(764).Buffer,a=n(361).inspect,c=a&&a.custom||"inspect";e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}var t,n;return t=e,n=[{key:"push",value:function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}},{key:"unshift",value:function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}},{key:"shift",value:function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var t=this.head,n=""+t.data;t=t.next;)n+=e+t.data;return n}},{key:"concat",value:function(e){if(0===this.length)return s.alloc(0);for(var t,n,r,i=s.allocUnsafe(e>>>0),o=this.head,a=0;o;)t=o.data,n=i,r=a,s.prototype.copy.call(t,n,r),a+=o.data.length,o=o.next;return i}},{key:"consume",value:function(e,t){var n;return e<this.head.data.length?(n=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):n=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),n}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(e){var t=this.head,n=1,r=t.data;for(e-=r.length;t=t.next;){var i=t.data,o=e>i.length?i.length:e;if(o===i.length?r+=i:r+=i.slice(0,e),0==(e-=o)){o===i.length?(++n,t.next?this.head=t.next:this.head=this.tail=null):(this.head=t,t.data=i.slice(o));break}++n}return this.length-=n,r}},{key:"_getBuffer",value:function(e){var t=s.allocUnsafe(e),n=this.head,r=1;for(n.data.copy(t),e-=n.data.length;n=n.next;){var i=n.data,o=e>i.length?i.length:e;if(i.copy(t,t.length-e,0,o),0==(e-=o)){o===i.length?(++r,n.next?this.head=n.next:this.head=this.tail=null):(this.head=n,n.data=i.slice(o));break}++r}return this.length-=r,t}},{key:c,value:function(e,t){return a(this,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},t,{depth:0,customInspect:!1}))}}],n&&o(t.prototype,n),e}()},195:(e,t,n)=>{"use strict";var r=n(155);function i(e,t){s(e,t),o(e)}function o(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function s(e,t){e.emit("error",t)}e.exports={destroy:function(e,t){var n=this,a=this._readableState&&this._readableState.destroyed,c=this._writableState&&this._writableState.destroyed;return a||c?(t?t(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,r.nextTick(s,this,e)):r.nextTick(s,this,e)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,(function(e){!t&&e?n._writableState?n._writableState.errorEmitted?r.nextTick(o,n):(n._writableState.errorEmitted=!0,r.nextTick(i,n,e)):r.nextTick(i,n,e):t?(r.nextTick(o,n),t(e)):r.nextTick(o,n)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,t){var n=e._readableState,r=e._writableState;n&&n.autoDestroy||r&&r.autoDestroy?e.destroy(t):e.emit("error",t)}}},610:(e,t,n)=>{"use strict";var r=n(281).q.ERR_STREAM_PREMATURE_CLOSE;function i(){}e.exports=function e(t,n,o){if("function"==typeof n)return e(t,null,n);n||(n={}),o=function(e){var t=!1;return function(){if(!t){t=!0;for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];e.apply(this,r)}}}(o||i);var s=n.readable||!1!==n.readable&&t.readable,a=n.writable||!1!==n.writable&&t.writable,c=function(){t.writable||l()},u=t._writableState&&t._writableState.finished,l=function(){a=!1,u=!0,s||o.call(t)},h=t._readableState&&t._readableState.endEmitted,d=function(){s=!1,h=!0,a||o.call(t)},f=function(e){o.call(t,e)},p=function(){var e;return s&&!h?(t._readableState&&t._readableState.ended||(e=new r),o.call(t,e)):a&&!u?(t._writableState&&t._writableState.ended||(e=new r),o.call(t,e)):void 0},m=function(){t.req.on("finish",l)};return function(e){return e.setHeader&&"function"==typeof e.abort}(t)?(t.on("complete",l),t.on("abort",p),t.req?m():t.on("request",m)):a&&!t._writableState&&(t.on("end",c),t.on("close",c)),t.on("end",d),t.on("finish",l),!1!==n.error&&t.on("error",f),t.on("close",p),function(){t.removeListener("complete",l),t.removeListener("abort",p),t.removeListener("request",m),t.req&&t.req.removeListener("finish",l),t.removeListener("end",c),t.removeListener("close",c),t.removeListener("finish",l),t.removeListener("end",d),t.removeListener("error",f),t.removeListener("close",p)}}},167:e=>{e.exports=function(){throw new Error("Readable.from is not available in the browser")}},946:(e,t,n)=>{"use strict";var r,i=n(281).q,o=i.ERR_MISSING_ARGS,s=i.ERR_STREAM_DESTROYED;function a(e){if(e)throw e}function c(e,t,i,o){o=function(e){var t=!1;return function(){t||(t=!0,e.apply(void 0,arguments))}}(o);var a=!1;e.on("close",(function(){a=!0})),void 0===r&&(r=n(610)),r(e,{readable:t,writable:i},(function(e){if(e)return o(e);a=!0,o()}));var c=!1;return function(t){if(!a&&!c)return c=!0,function(e){return e.setHeader&&"function"==typeof e.abort}(e)?e.abort():"function"==typeof e.destroy?e.destroy():void o(t||new s("pipe"))}}function u(e){e()}function l(e,t){return e.pipe(t)}function h(e){return e.length?"function"!=typeof e[e.length-1]?a:e.pop():a}e.exports=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r,i=h(t);if(Array.isArray(t[0])&&(t=t[0]),t.length<2)throw new o("streams");var s=t.map((function(e,n){var o=n<t.length-1;return c(e,o,n>0,(function(e){r||(r=e),e&&s.forEach(u),o||(s.forEach(u),i(r))}))}));return t.reduce(l)}},457:(e,t,n)=>{"use strict";var r=n(281).q.ERR_INVALID_OPT_VALUE;e.exports={getHighWaterMark:function(e,t,n,i){var o=function(e,t,n){return null!=e.highWaterMark?e.highWaterMark:t?e[n]:null}(t,i,n);if(null!=o){if(!isFinite(o)||Math.floor(o)!==o||o<0)throw new r(i?n:"highWaterMark",o);return Math.floor(o)}return e.objectMode?16:16384}}},503:(e,t,n)=>{e.exports=n(187).EventEmitter},509:(e,t,n)=>{var r=n(764),i=r.Buffer;function o(e,t){for(var n in e)t[n]=e[n]}function s(e,t,n){return i(e,t,n)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?e.exports=r:(o(r,t),t.Buffer=s),s.prototype=Object.create(i.prototype),o(i,s),s.from=function(e,t,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return i(e,t,n)},s.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");var r=i(e);return void 0!==t?"string"==typeof n?r.fill(t,n):r.fill(t):r.fill(0),r},s.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i(e)},s.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r.SlowBuffer(e)}},830:(e,t,n)=>{e.exports=i;var r=n(187).EventEmitter;function i(){r.call(this)}n(717)(i,r),i.Readable=n(481),i.Writable=n(229),i.Duplex=n(753),i.Transform=n(605),i.PassThrough=n(725),i.finished=n(610),i.pipeline=n(946),i.Stream=i,i.prototype.pipe=function(e,t){var n=this;function i(t){e.writable&&!1===e.write(t)&&n.pause&&n.pause()}function o(){n.readable&&n.resume&&n.resume()}n.on("data",i),e.on("drain",o),e._isStdio||t&&!1===t.end||(n.on("end",a),n.on("close",c));var s=!1;function a(){s||(s=!0,e.end())}function c(){s||(s=!0,"function"==typeof e.destroy&&e.destroy())}function u(e){if(l(),0===r.listenerCount(this,"error"))throw e}function l(){n.removeListener("data",i),e.removeListener("drain",o),n.removeListener("end",a),n.removeListener("close",c),n.removeListener("error",u),e.removeListener("error",u),n.removeListener("end",l),n.removeListener("close",l),e.removeListener("close",l)}return n.on("error",u),e.on("error",u),n.on("end",l),n.on("close",l),e.on("close",l),e.emit("pipe",n),e}},553:(e,t,n)=>{"use strict";var r=n(509).Buffer,i=r.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function o(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(r.isEncoding===i||!i(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=c,this.end=u,t=4;break;case"utf8":this.fillLast=a,t=4;break;case"base64":this.text=l,this.end=h,t=3;break;default:return this.write=d,void(this.end=f)}this.lastNeed=0,this.lastTotal=0,this.lastChar=r.allocUnsafe(t)}function s(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function a(e){var t=this.lastTotal-this.lastNeed,n=function(e,t,n){if(128!=(192&t[0]))return e.lastNeed=0,"";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,""}}(this,e);return void 0!==n?n:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function c(e,t){if((e.length-t)%2==0){var n=e.toString("utf16le",t);if(n){var r=n.charCodeAt(n.length-1);if(r>=55296&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],n.slice(0,-1)}return n}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function u(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var n=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,n)}return t}function l(e,t){var n=(e.length-t)%3;return 0===n?e.toString("base64",t):(this.lastNeed=3-n,this.lastTotal=3,1===n?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-n))}function h(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function d(e){return e.toString(this.encoding)}function f(e){return e&&e.length?this.write(e):""}t.s=o,o.prototype.write=function(e){if(0===e.length)return"";var t,n;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<e.length?t?t+this.text(e,n):this.text(e,n):t||""},o.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"":t},o.prototype.text=function(e,t){var n=function(e,t,n){var r=t.length-1;if(r<n)return 0;var i=s(t[r]);return i>=0?(i>0&&(e.lastNeed=i-1),i):--r<n||-2===i?0:(i=s(t[r]))>=0?(i>0&&(e.lastNeed=i-2),i):--r<n||-2===i?0:(i=s(t[r]))>=0?(i>0&&(2===i?i=0:e.lastNeed=i-3),i):0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=n;var r=e.length-(n-this.lastNeed);return e.copy(this.lastChar,0,r),e.toString("utf8",t,r)},o.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},758:(e,t)=>{"use strict";var n=function(){function e(){this._state=new Int32Array(4),this._buffer=new ArrayBuffer(68),this._buffer8=new Uint8Array(this._buffer,0,68),this._buffer32=new Uint32Array(this._buffer,0,17),this.start()}return e.hashStr=function(e,t){return void 0===t&&(t=!1),this.onePassHasher.start().appendStr(e).end(t)},e.hashAsciiStr=function(e,t){return void 0===t&&(t=!1),this.onePassHasher.start().appendAsciiStr(e).end(t)},e._hex=function(t){var n,r,i,o,s=e.hexChars,a=e.hexOut;for(o=0;o<4;o+=1)for(r=8*o,n=t[o],i=0;i<8;i+=2)a[r+1+i]=s.charAt(15&n),n>>>=4,a[r+0+i]=s.charAt(15&n),n>>>=4;return a.join("")},e._md5cycle=function(e,t){var n=e[0],r=e[1],i=e[2],o=e[3];r=((r+=((i=((i+=((o=((o+=((n=((n+=(r&i|~r&o)+t[0]-680876936|0)<<7|n>>>25)+r|0)&r|~n&i)+t[1]-389564586|0)<<12|o>>>20)+n|0)&n|~o&r)+t[2]+606105819|0)<<17|i>>>15)+o|0)&o|~i&n)+t[3]-1044525330|0)<<22|r>>>10)+i|0,r=((r+=((i=((i+=((o=((o+=((n=((n+=(r&i|~r&o)+t[4]-176418897|0)<<7|n>>>25)+r|0)&r|~n&i)+t[5]+1200080426|0)<<12|o>>>20)+n|0)&n|~o&r)+t[6]-1473231341|0)<<17|i>>>15)+o|0)&o|~i&n)+t[7]-45705983|0)<<22|r>>>10)+i|0,r=((r+=((i=((i+=((o=((o+=((n=((n+=(r&i|~r&o)+t[8]+1770035416|0)<<7|n>>>25)+r|0)&r|~n&i)+t[9]-1958414417|0)<<12|o>>>20)+n|0)&n|~o&r)+t[10]-42063|0)<<17|i>>>15)+o|0)&o|~i&n)+t[11]-1990404162|0)<<22|r>>>10)+i|0,r=((r+=((i=((i+=((o=((o+=((n=((n+=(r&i|~r&o)+t[12]+1804603682|0)<<7|n>>>25)+r|0)&r|~n&i)+t[13]-40341101|0)<<12|o>>>20)+n|0)&n|~o&r)+t[14]-1502002290|0)<<17|i>>>15)+o|0)&o|~i&n)+t[15]+1236535329|0)<<22|r>>>10)+i|0,r=((r+=((i=((i+=((o=((o+=((n=((n+=(r&o|i&~o)+t[1]-165796510|0)<<5|n>>>27)+r|0)&i|r&~i)+t[6]-1069501632|0)<<9|o>>>23)+n|0)&r|n&~r)+t[11]+643717713|0)<<14|i>>>18)+o|0)&n|o&~n)+t[0]-373897302|0)<<20|r>>>12)+i|0,r=((r+=((i=((i+=((o=((o+=((n=((n+=(r&o|i&~o)+t[5]-701558691|0)<<5|n>>>27)+r|0)&i|r&~i)+t[10]+38016083|0)<<9|o>>>23)+n|0)&r|n&~r)+t[15]-660478335|0)<<14|i>>>18)+o|0)&n|o&~n)+t[4]-405537848|0)<<20|r>>>12)+i|0,r=((r+=((i=((i+=((o=((o+=((n=((n+=(r&o|i&~o)+t[9]+568446438|0)<<5|n>>>27)+r|0)&i|r&~i)+t[14]-1019803690|0)<<9|o>>>23)+n|0)&r|n&~r)+t[3]-187363961|0)<<14|i>>>18)+o|0)&n|o&~n)+t[8]+1163531501|0)<<20|r>>>12)+i|0,r=((r+=((i=((i+=((o=((o+=((n=((n+=(r&o|i&~o)+t[13]-1444681467|0)<<5|n>>>27)+r|0)&i|r&~i)+t[2]-51403784|0)<<9|o>>>23)+n|0)&r|n&~r)+t[7]+1735328473|0)<<14|i>>>18)+o|0)&n|o&~n)+t[12]-1926607734|0)<<20|r>>>12)+i|0,r=((r+=((i=((i+=((o=((o+=((n=((n+=(r^i^o)+t[5]-378558|0)<<4|n>>>28)+r|0)^r^i)+t[8]-2022574463|0)<<11|o>>>21)+n|0)^n^r)+t[11]+1839030562|0)<<16|i>>>16)+o|0)^o^n)+t[14]-35309556|0)<<23|r>>>9)+i|0,r=((r+=((i=((i+=((o=((o+=((n=((n+=(r^i^o)+t[1]-1530992060|0)<<4|n>>>28)+r|0)^r^i)+t[4]+1272893353|0)<<11|o>>>21)+n|0)^n^r)+t[7]-155497632|0)<<16|i>>>16)+o|0)^o^n)+t[10]-1094730640|0)<<23|r>>>9)+i|0,r=((r+=((i=((i+=((o=((o+=((n=((n+=(r^i^o)+t[13]+681279174|0)<<4|n>>>28)+r|0)^r^i)+t[0]-358537222|0)<<11|o>>>21)+n|0)^n^r)+t[3]-722521979|0)<<16|i>>>16)+o|0)^o^n)+t[6]+76029189|0)<<23|r>>>9)+i|0,r=((r+=((i=((i+=((o=((o+=((n=((n+=(r^i^o)+t[9]-640364487|0)<<4|n>>>28)+r|0)^r^i)+t[12]-421815835|0)<<11|o>>>21)+n|0)^n^r)+t[15]+530742520|0)<<16|i>>>16)+o|0)^o^n)+t[2]-995338651|0)<<23|r>>>9)+i|0,r=((r+=((o=((o+=(r^((n=((n+=(i^(r|~o))+t[0]-198630844|0)<<6|n>>>26)+r|0)|~i))+t[7]+1126891415|0)<<10|o>>>22)+n|0)^((i=((i+=(n^(o|~r))+t[14]-1416354905|0)<<15|i>>>17)+o|0)|~n))+t[5]-57434055|0)<<21|r>>>11)+i|0,r=((r+=((o=((o+=(r^((n=((n+=(i^(r|~o))+t[12]+1700485571|0)<<6|n>>>26)+r|0)|~i))+t[3]-1894986606|0)<<10|o>>>22)+n|0)^((i=((i+=(n^(o|~r))+t[10]-1051523|0)<<15|i>>>17)+o|0)|~n))+t[1]-2054922799|0)<<21|r>>>11)+i|0,r=((r+=((o=((o+=(r^((n=((n+=(i^(r|~o))+t[8]+1873313359|0)<<6|n>>>26)+r|0)|~i))+t[15]-30611744|0)<<10|o>>>22)+n|0)^((i=((i+=(n^(o|~r))+t[6]-1560198380|0)<<15|i>>>17)+o|0)|~n))+t[13]+1309151649|0)<<21|r>>>11)+i|0,r=((r+=((o=((o+=(r^((n=((n+=(i^(r|~o))+t[4]-145523070|0)<<6|n>>>26)+r|0)|~i))+t[11]-1120210379|0)<<10|o>>>22)+n|0)^((i=((i+=(n^(o|~r))+t[2]+718787259|0)<<15|i>>>17)+o|0)|~n))+t[9]-343485551|0)<<21|r>>>11)+i|0,e[0]=n+e[0]|0,e[1]=r+e[1]|0,e[2]=i+e[2]|0,e[3]=o+e[3]|0},e.prototype.start=function(){return this._dataLength=0,this._bufferLength=0,this._state.set(e.stateIdentity),this},e.prototype.appendStr=function(t){var n,r,i=this._buffer8,o=this._buffer32,s=this._bufferLength;for(r=0;r<t.length;r+=1){if((n=t.charCodeAt(r))<128)i[s++]=n;else if(n<2048)i[s++]=192+(n>>>6),i[s++]=63&n|128;else if(n<55296||n>56319)i[s++]=224+(n>>>12),i[s++]=n>>>6&63|128,i[s++]=63&n|128;else{if((n=1024*(n-55296)+(t.charCodeAt(++r)-56320)+65536)>1114111)throw new Error("Unicode standard supports code points up to U+10FFFF");i[s++]=240+(n>>>18),i[s++]=n>>>12&63|128,i[s++]=n>>>6&63|128,i[s++]=63&n|128}s>=64&&(this._dataLength+=64,e._md5cycle(this._state,o),s-=64,o[0]=o[16])}return this._bufferLength=s,this},e.prototype.appendAsciiStr=function(t){for(var n,r=this._buffer8,i=this._buffer32,o=this._bufferLength,s=0;;){for(n=Math.min(t.length-s,64-o);n--;)r[o++]=t.charCodeAt(s++);if(o<64)break;this._dataLength+=64,e._md5cycle(this._state,i),o=0}return this._bufferLength=o,this},e.prototype.appendByteArray=function(t){for(var n,r=this._buffer8,i=this._buffer32,o=this._bufferLength,s=0;;){for(n=Math.min(t.length-s,64-o);n--;)r[o++]=t[s++];if(o<64)break;this._dataLength+=64,e._md5cycle(this._state,i),o=0}return this._bufferLength=o,this},e.prototype.getState=function(){var e=this,t=e._state;return{buffer:String.fromCharCode.apply(null,e._buffer8),buflen:e._bufferLength,length:e._dataLength,state:[t[0],t[1],t[2],t[3]]}},e.prototype.setState=function(e){var t,n=e.buffer,r=e.state,i=this._state;for(this._dataLength=e.length,this._bufferLength=e.buflen,i[0]=r[0],i[1]=r[1],i[2]=r[2],i[3]=r[3],t=0;t<n.length;t+=1)this._buffer8[t]=n.charCodeAt(t)},e.prototype.end=function(t){void 0===t&&(t=!1);var n,r=this._bufferLength,i=this._buffer8,o=this._buffer32,s=1+(r>>2);if(this._dataLength+=r,i[r]=128,i[r+1]=i[r+2]=i[r+3]=0,o.set(e.buffer32Identity.subarray(s),s),r>55&&(e._md5cycle(this._state,o),o.set(e.buffer32Identity)),(n=8*this._dataLength)<=4294967295)o[14]=n;else{var a=n.toString(16).match(/(.*?)(.{0,8})$/);if(null===a)return;var c=parseInt(a[2],16),u=parseInt(a[1],16)||0;o[14]=c,o[15]=u}return e._md5cycle(this._state,o),t?this._state:e._hex(this._state)},e.stateIdentity=new Int32Array([1732584193,-271733879,-1732584194,271733878]),e.buffer32Identity=new Int32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),e.hexChars="0123456789abcdef",e.hexOut=[],e.onePassHasher=new e,e}();t.V=n,"5d41402abc4b2a76b9719d911017c592"!==n.hashStr("hello")&&console.error("Md5 self test failed.")},927:(e,t,n)=>{function r(e){try{if(!n.g.localStorage)return!1}catch(e){return!1}var t=n.g.localStorage[e];return null!=t&&"true"===String(t).toLowerCase()}e.exports=function(e,t){if(r("noDeprecation"))return e;var n=!1;return function(){if(!n){if(r("throwDeprecation"))throw new Error(t);r("traceDeprecation")?console.trace(t):console.warn(t),n=!0}return e.apply(this,arguments)}}},361:()=>{},616:()=>{}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};return(()=>{"use strict";n.r(r),n.d(r,{AACDepay:()=>P,BasicDepay:()=>B,CanvasSink:()=>D,H264Depay:()=>J,Html5CanvasPipeline:()=>xn,Html5VideoMetadataPipeline:()=>Pn,Html5VideoPipeline:()=>In,HttpMsePipeline:()=>Hn,HttpSource:()=>ee,Inspector:()=>ne,JPEGDepay:()=>Re,MessageType:()=>k,MetadataPipeline:()=>Ln,Mp4Capture:()=>ke,Mp4Muxer:()=>st,MseSink:()=>kt,ONVIFDepay:()=>Pt,Pipeline:()=>pn,RTCPPacketType:()=>lt,RTSPResponseError:()=>cn,RTSP_METHOD:()=>an,RtspMjpegPipeline:()=>vn,RtspMp4Pipeline:()=>bn,RtspParser:()=>Qt,RtspPipeline:()=>gn,RtspSession:()=>un,SDESItem:()=>vt,SR:()=>ft,Scheduler:()=>U,Sink:()=>d,Source:()=>l,Tube:()=>h,WSSource:()=>dn,WsSdpPipeline:()=>Mn,addRTSPRetry:()=>$n,bodyOffset:()=>Yt,cSrc:()=>T,cSrcCount:()=>b,components:()=>e,connectionEnded:()=>Vt,contentBase:()=>Wt,contentLocation:()=>zt,createTransform:()=>I,extHeader:()=>C,extHeaderLength:()=>R,extension:()=>y,extractHeaderValue:()=>Nt,extractURIs:()=>Ut,getTime:()=>nn,isRtcpApp:()=>Rt,isRtcpBye:()=>St,isRtcpRR:()=>bt,isRtcpSDES:()=>_t,isRtcpSR:()=>gt,marker:()=>v,messageFromBuffer:()=>Dt,padding:()=>g,parse:()=>jt,parseRtcp:()=>ht,payload:()=>x,payloadType:()=>w,pipelines:()=>t,range:()=>Gt,rtcpMessageFromBuffer:()=>dt,sSrc:()=>S,sequence:()=>Ft,sequenceNumber:()=>_,sessionId:()=>qt,sessionTimeout:()=>Ht,statusCode:()=>$t,timestamp:()=>E,utils:()=>i,version:()=>m});var e={};n.r(e),n.d(e,{AACDepay:()=>P,BasicDepay:()=>B,CanvasSink:()=>D,H264Depay:()=>J,HttpSource:()=>ee,Inspector:()=>ne,JPEGDepay:()=>Re,MessageType:()=>k,Mp4Capture:()=>ke,Mp4Muxer:()=>st,MseSink:()=>kt,ONVIFDepay:()=>Pt,RTSPResponseError:()=>cn,RTSP_METHOD:()=>an,RtspParser:()=>Qt,RtspSession:()=>un,Sink:()=>d,Source:()=>l,Tube:()=>h,WSSource:()=>dn,createTransform:()=>I});var t={};n.r(t),n.d(t,{Html5CanvasPipeline:()=>xn,Html5VideoMetadataPipeline:()=>Pn,Html5VideoPipeline:()=>In,HttpMsePipeline:()=>Hn,MetadataPipeline:()=>Ln,Pipeline:()=>pn,RtspMjpegPipeline:()=>vn,RtspMp4Pipeline:()=>bn,RtspPipeline:()=>gn,WsSdpPipeline:()=>Mn});var i={};n.r(i),n.d(i,{RTCPPacketType:()=>lt,SDESItem:()=>vt,SR:()=>ft,Scheduler:()=>U,addRTSPRetry:()=>$n,bodyOffset:()=>Yt,cSrc:()=>T,cSrcCount:()=>b,connectionEnded:()=>Vt,contentBase:()=>Wt,contentLocation:()=>zt,extHeader:()=>C,extHeaderLength:()=>R,extension:()=>y,extractHeaderValue:()=>Nt,extractURIs:()=>Ut,getTime:()=>nn,isRtcpApp:()=>Rt,isRtcpBye:()=>St,isRtcpRR:()=>bt,isRtcpSDES:()=>_t,isRtcpSR:()=>gt,marker:()=>v,messageFromBuffer:()=>Dt,padding:()=>g,parse:()=>jt,parseRtcp:()=>ht,payload:()=>x,payloadType:()=>w,range:()=>Gt,rtcpMessageFromBuffer:()=>dt,sSrc:()=>S,sequence:()=>Ft,sequenceNumber:()=>_,sessionId:()=>qt,sessionTimeout:()=>Ht,statusCode:()=>$t,timestamp:()=>E,version:()=>m});var o=n(830),s=n(764).Buffer;class a{static consumer(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:()=>{};return new o.Writable({objectMode:!0,write(t,n,r){e(t),r()}})}static peeker(e){if("function"!=typeof e)throw new Error("you must supply a function");return new o.Transform({objectMode:!0,transform(t,n,r){e(t),r(void 0,t)}})}static producer(e){let t=0;return new o.Readable({objectMode:!0,read(){void 0!==e&&(t<e.length?this.push(e[t++]):this.push(null))}})}static recorder(e,t){return new o.Transform({objectMode:!0,transform(n,r,i){const o=Date.now(),s=Object.assign({},n,{data:n.data.toString("base64")});t.write(JSON.stringify({type:e,timestamp:o,message:s},null,2)),t.write(",\n"),i(void 0,n)}})}static replayer(e){let t=0,n=e[0].timestamp;return new o.Readable({objectMode:!0,read(){const r=e[t++];if(r){const{type:e,timestamp:t,message:i}=r,o=t-n;if(n=t,i){const t=i.data?s.from(i.data,"base64"):s.alloc(0),n=Object.assign({},i,{data:t});this.push({type:e,delay:o,msg:n})}else this.push({type:e,delay:o,msg:null})}else this.push(null)}})}}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class u{constructor(){c(this,"incoming",void 0),c(this,"outgoing",void 0),c(this,"next",void 0),c(this,"prev",void 0),c(this,"_incomingErrorHandler",void 0),c(this,"_outgoingErrorHandler",void 0)}}class l extends u{static fromMessages(e){return new l(a.producer(e),a.consumer())}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new o.Readable({objectMode:!0}),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new o.Writable({objectMode:!0});super(),c(this,"incoming",void 0),c(this,"outgoing",void 0),c(this,"next",void 0),c(this,"prev",void 0),this.incoming=e,this.outgoing=t,this.next=null,this.prev=null}connect(e){if(null===e)return this;if(null!==this.next||null!==e.prev)throw new Error("connection failed: component(s) already connected");if(!this.incoming.readable||!this.outgoing.writable)throw new Error("connection failed: this component not compatible");if(!e.incoming.writable||!e.outgoing.readable)throw new Error("connection failed: next component not compatible");try{this.incoming.pipe(e.incoming),e.outgoing.pipe(this.outgoing)}catch(e){throw new Error(`connection failed: ${e.message}`)}const t=e=>{this.incoming.emit("error",e)};e.incoming.on("error",t);const n=t=>{e.outgoing.emit("error",t)};return this.outgoing.on("error",n),this.next=e,e.prev=this,this._incomingErrorHandler=t,this._outgoingErrorHandler=n,e}disconnect(){const e=this.next;return null!==e&&(this.incoming.unpipe(e.incoming),e.outgoing.unpipe(this.outgoing),void 0!==this._incomingErrorHandler&&e.incoming.removeListener("error",this._incomingErrorHandler),void 0!==this._outgoingErrorHandler&&this.outgoing.removeListener("error",this._outgoingErrorHandler),this.next=null,e.prev=null,delete this._incomingErrorHandler,delete this._outgoingErrorHandler),this}}class h extends l{static fromHandlers(e,t){const n=e?a.peeker(e):void 0,r=t?a.peeker(t):void 0;return new h(n,r)}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new o.PassThrough({objectMode:!0}),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new o.PassThrough({objectMode:!0});super(e,t),c(this,"incoming",void 0),c(this,"outgoing",void 0),this.incoming=e,this.outgoing=t}}class d extends u{static fromHandler(e){const t=new d(a.consumer(e),a.producer(void 0));return t.incoming.on("finish",(()=>{t.outgoing.push(null)})),t}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new o.Writable({objectMode:!0}),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new o.Readable({objectMode:!0});super(),c(this,"incoming",void 0),c(this,"outgoing",void 0),c(this,"next",void 0),c(this,"prev",void 0),this.incoming=e,this.outgoing=t,this.next=null,this.prev=null}connect(){throw new Error("connection failed: attempting to connect after a sink")}disconnect(){return this}}const f=[128,64,32,16,8,4,2,1];var p=n(764).Buffer;const m=e=>e[0]>>>6,g=e=>!!(e[0]&f[2]),y=e=>!!(e[0]&f[3]),b=e=>15&e[0],v=e=>!!(e[1]&f[0]),w=e=>127&e[1],_=e=>e.readUInt16BE(2),E=e=>e.readUInt32BE(4),S=e=>e.readUInt32BE(8),T=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return b(e)>t?e.readUInt32BE(12+4*t):0},R=e=>y(e)?e.readUInt16BE(12+4*b(e)+2):0,C=e=>0===R(e)?p.from([]):e.slice(12+4*b(e),12+4*b(e)+4+4*R(e)),x=e=>y(e)?e.slice(12+4*b(e)+4+4*R(e)):e.slice(12+4*b(e));let k;!function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.RAW=1]="RAW",e[e.RTP=2]="RTP",e[e.RTCP=3]="RTCP",e[e.RTSP=4]="RTSP",e[e.SDP=5]="SDP",e[e.ELEMENTARY=6]="ELEMENTARY",e[e.H264=7]="H264",e[e.ISOM=8]="ISOM",e[e.XML=9]="XML",e[e.JPEG=10]="JPEG"}(k||(k={}));const I=e=>new o.Transform({objectMode:!0,transform:e});class P extends h{constructor(){let e,t;super(I((function(n,r,i){if(n.type===k.SDP){let r;for(const e of n.sdp.media)"audio"===e.type&&e.fmtp&&e.fmtp.parameters&&"AAC-hbr"===e.fmtp.parameters.mode&&(r=e);if(r&&void 0!==r.rtpmap){e=Number(r.rtpmap.payloadType);const n=r.fmtp.parameters,i=Number(n.sizelength)||0,o=Number(n.indexlength)||0,s=Number(n.indexdeltalength)||0,a=Number(n.ctsdeltalength)||0,c=Number(n.dtsdeltalength)||0,u=Number(n.randomaccessindication)||0,l=Number(n.streamstateindication)||0,h=Number(n.auxiliarydatasizelength)||0;t=i+Math.max(o,s)+a+c+u+l+h>0}i(void 0,n)}else n.type===k.RTP&&w(n.data)===e?(function(e,t,n){const r=x(e.data);let i=0;if(t){const e=r.readUInt16BE(0);i=2+(e+e%8)/8}n({type:k.ELEMENTARY,data:r.slice(i),payloadType:w(e.data),timestamp:E(e.data),ntpTimestamp:e.ntpTimestamp})}(n,t,this.push.bind(this)),i()):i(void 0,n)})))}}var O=n(764).Buffer;class B extends h{constructor(e){if(void 0===e)throw new Error("you must supply a payload type to BasicDepayComponent");let t=O.alloc(0);super(I((function(n,r,i){if(n.type===k.RTP&&w(n.data)===e){const e=x(n.data);t=O.concat([t,e]),v(n.data)&&(t.length>0&&this.push({data:t,timestamp:E(n.data),ntpTimestamp:n.ntpTimestamp,payloadType:w(n.data),type:k.ELEMENTARY}),t=O.alloc(0)),i()}else i(void 0,n)})))}}function L(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class A{constructor(){L(this,"started",void 0),L(this,"stopped",void 0),L(this,"elapsed",void 0),this.elapsed=0,this.started=0,this.stopped=!0}start(){this.stopped&&(this.started=window.performance.now(),this.stopped=!1)}stop(){this.stopped||(this.elapsed=this.now(),this.stopped=!0)}reset(){this.elapsed=0,this.started=0,this.stopped=!0}now(){return this.stopped?this.elapsed:this.elapsed+(window.performance.now()-this.started)}play(){this.start()}pause(){this.stop()}get currentTime(){return this.now()/1e3}}function M(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class U{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;M(this,"_clock",void 0),M(this,"_handler",void 0),M(this,"_tolerance",void 0),M(this,"_nextRun",void 0),M(this,"_nextPlay",void 0),M(this,"_fifo",void 0),M(this,"_ntpPresentationTime",void 0),M(this,"_suspended",void 0),this._clock=e,this._handler=t,this._tolerance=n,this._nextRun=0,this._nextPlay=0,this._fifo=[],this._ntpPresentationTime=0,this._suspended=!1}reset(){clearTimeout(this._nextRun),clearTimeout(this._nextPlay),this._fifo=[],this._ntpPresentationTime=0,this._suspended=!1}init(e){this._ntpPresentationTime=e}suspend(){clearTimeout(this._nextPlay),this._suspended=!0}resume(){this._suspended=!1,this.run(void 0)}run(e){if(clearTimeout(this._nextRun),void 0===this._ntpPresentationTime)return;if(void 0!==e&&this._fifo.push(e),this._suspended)return;if(0===this._fifo.length)return;let t,n=0;do{const e=this._fifo.shift();if(void 0===e)throw new Error("internal error: message should never be undefined");t=e;const r=t.ntpTimestamp;void 0!==r&&(n=r-this._ntpPresentationTime-1e3*this._clock.currentTime,Math.abs(n)<this._tolerance&&this._handler&&this._handler(t))}while(n<this._tolerance&&this._fifo.length>0);n<-this._tolerance?(clearTimeout(this._nextPlay),this._clock.pause(),this._nextPlay=window.setTimeout((()=>this._clock.play()),-n)):n>this._tolerance&&(this._fifo.unshift(t),this._nextRun=window.setTimeout((()=>this.run(void 0)),n))}}function j(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class D extends d{constructor(e){if(void 0===e)throw new Error("canvas element argument missing");let t=0,n=0,r=0;const i={bitrate:0,framerate:0,renderedFrames:0};let s,a,c=null;if(void 0!==window.createImageBitmap&&(c=e.getContext("bitmaprenderer")),null===c&&(c=e.getContext("2d")),null===c)a=()=>{};else if("transferFromImageBitmap"in c){const e=c;a=t=>{let{blob:n}=t;i.renderedFrames++,window.createImageBitmap(n).then((t=>{e.transferFromImageBitmap(t)})).catch((()=>{}))}}else{const e=c,t=new Image;t.onload=()=>{e.drawImage(t,0,0)},a=e=>{let{blob:n}=e;i.renderedFrames++;const r=window.URL.createObjectURL(n);t.src=r}}const u=new A,l=new U(u,a);let h=0;const d=()=>{this.onCanplay&&this.onCanplay()},f=e=>{this.onSync&&this.onSync(e)},p=new o.Writable({objectMode:!0,write:(o,a,c)=>{if(o.type===k.SDP){u.reset(),l.reset(),t=0;const e=o.sdp.media.find((e=>"video"===e.type&&void 0!==e.rtpmap&&"JPEG"===e.rtpmap.encodingName));void 0!==e&&void 0!==e.rtpmap&&(r=e.rtpmap.clockrate,(e=>{e.bitrate=0,e.framerate=0,e.renderedFrames=0})(i),s=(e=>{let t=0,n=0,r=0;return(i,o)=>{let{byteLength:s,duration:a}=o;if(t+=s,n+=a,r++,n>=e){const o=8*t,s=r,a=n/e;i.bitrate=o/a,i.framerate=s/a,t=0,n=0,r=0}}})(r)),c()}else if(o.type===k.JPEG){const{timestamp:a,ntpTimestamp:u}=o;if(!t){t=a,n=a;const{width:r,height:i}=o.framesize;e.width=r,e.height=i,l.init(0)}const p=1e3*(a-t)/r,m=new window.Blob([o.data],{type:"image/jpeg"});!h&&u&&(h=u-p,f(h)),l.run({ntpTimestamp:p,blob:m}),a===t&&d(),s(i,{byteLength:o.data.length,duration:a-n}),n=a,c()}else c()}}),m=new o.Readable({objectMode:!0,read:function(){}});m.on("error",(()=>{console.warn("outgoing stream broke somewhere")})),super(p,m),j(this,"onCanplay",void 0),j(this,"onSync",void 0),j(this,"_clock",void 0),j(this,"_scheduler",void 0),j(this,"_info",void 0),this._clock=u,this._scheduler=l,this._info=i,this.onCanplay=void 0,this.onSync=void 0}get currentTime(){return this._clock.currentTime}pause(){this._scheduler.suspend(),this._clock.pause()}play(){this._clock.play(),this._scheduler.resume()}get bitrate(){return this._info.bitrate}get framerate(){return this._info.framerate}}var N=n(227),F=n.n(N),q=n(764).Buffer;let H;!function(e){e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.NON_IDR_PICTURE=1]="NON_IDR_PICTURE",e[e.IDR_PICTURE=5]="IDR_PICTURE",e[e.SPS=7]="SPS",e[e.PPS=8]="PPS"}(H||(H={}));const $=F()("msl:h264depay");class W{constructor(){var e,t;t=void 0,(e="_buffer")in this?Object.defineProperty(this,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):this[e]=t,this._buffer=q.alloc(0)}parse(e){const t=x(e.data),n=31&t[0];if(28===n){const n=t[0],r=t[1],i=31&r,o=224&n|i,s=64&r;if(r>>7)return this._buffer=q.concat([q.from([0,0,0,0,o]),t.slice(2)]),null;if(s){const n=q.concat([this._buffer,t.slice(2)]);n.writeUInt32BE(n.length-4,0);const r={data:n,type:k.H264,timestamp:E(e.data),ntpTimestamp:e.ntpTimestamp,payloadType:w(e.data),nalType:i};return this._buffer=q.alloc(0),r}return this._buffer=q.concat([this._buffer,t.slice(2)]),null}if(n!==H.NON_IDR_PICTURE&&n!==H.IDR_PICTURE||0!==this._buffer.length)return $(`H264depayComponent can only extract types 1,5 and 28, got ${n}`),this._buffer=q.alloc(0),null;{const r=q.concat([q.from([0,0,0,0]),t]);r.writeUInt32BE(r.length-4,0);const i={data:r,type:k.H264,timestamp:E(e.data),ntpTimestamp:e.ntpTimestamp,payloadType:w(e.data),nalType:n};return this._buffer=q.alloc(0),i}}}var z=n(764).Buffer;function V(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function G(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?V(Object(n),!0).forEach((function(t){Y(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):V(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class J extends h{constructor(){let e,t=!1,n=[];const r=new W;super(new o.Transform({objectMode:!0,transform:function(i,o,s){if(i.type===k.SDP){const t=i.sdp.media.find((e=>"video"===e.type&&void 0!==e.rtpmap&&"H264"===e.rtpmap.encodingName));void 0!==t&&void 0!==t.rtpmap&&(e=t.rtpmap.payloadType),s(void 0,i)}else if(i.type===k.RTP&&w(i.data)===e){const e=v(i.data),o=r.parse(i);if(null===o||!t&&o.nalType!==H.IDR_PICTURE)return void s();t=!0,n.push(o.data),e&&(this.push(G(G({},o),{},{data:1===n.length?n[0]:z.concat(n)})),n=[]),s()}else s(void 0,i)}}))}}var K=n(764).Buffer;function X(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Z(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Q=F()("msl:http-source");class ee extends l{constructor(e){const{uri:t,options:n}=e,r=new o.Readable({objectMode:!0,read:function(){}});r.on("error",(e=>{console.warn("closing socket due to incoming error",e),this._reader&&this._reader.cancel()})),super(r),Z(this,"uri",void 0),Z(this,"options",void 0),Z(this,"length",void 0),Z(this,"onHeaders",void 0),Z(this,"onServerClose",void 0),Z(this,"_reader",void 0),Z(this,"_abortController",void 0),Z(this,"_allDone",void 0),r._read=()=>{this._pull()},this.uri=t,this.options=n,this._allDone=!1}play(){if(void 0===this.uri)throw new Error("cannot start playing when there is no URI");this._abortController=new AbortController,this.length=0,fetch(this.uri,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?X(Object(n),!0).forEach((function(t){Z(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):X(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({credentials:"include",signal:this._abortController.signal},this.options)).then((e=>{if(null===e.body)throw new Error("empty response body");this.onHeaders&&this.onHeaders(e.headers),this._reader=e.body.getReader(),this._pull()})).catch((e=>{console.error("http-source: fetch failed: ",e)}))}abort(){this._reader&&this._reader.cancel().catch((e=>{console.log("http-source: cancel reader failed: ",e)})),this._abortController&&this._abortController.abort()}_isClosed(){return this._allDone}_close(){var e;this._reader=void 0,this._allDone=!0,this.incoming.push(null),null===(e=this.onServerClose)||void 0===e||e.call(this)}_pull(){void 0!==this._reader&&this._reader.read().then((e=>{let{done:t,value:n}=e;if(t)return void(this._isClosed()||(Q("fetch completed, total downloaded: ",this.length," bytes"),this._close()));if(void 0===n)throw new Error("expected value to be defined");if(void 0===this.length)throw new Error("expected length to be defined");this.length+=n.length;const r=K.from(n);this.incoming.push({data:r,type:k.RAW})?this._pull():Q("downstream back pressure: pausing read")})).catch((e=>{Q("http-source: read failed: ",e),this._isClosed()||this._close()}))}}const te=(e,t)=>{let n=Date.now();const r=t=>{const r=Date.now();console.log(`${e}: +${r-n}ms`,t),n=r};return void 0===t?r:e=>e.type===t&&r(e)};class ne extends h{constructor(e){const t=te("incoming",e),n=new o.Transform({objectMode:!0,transform:function(e,n,r){t(e),r(void 0,e)}}),r=te("outgoing",e);super(n,new o.Transform({objectMode:!0,transform:function(e,t,n){r(e),n(void 0,e)}}))}}var re=n(764).Buffer;function ie(){return re.from([255,216])}function oe(e,t){const n=1&e?128:64,r=2&e?128:64;if(t.length!==n+r)throw new Error("invalid quantization table");const i=re.from([255,219,0,n+3,0]),o=re.from([255,219,0,r+3,1]);return re.concat([i,t.slice(0,n),o,t.slice(n)])}function se(e,t,n){return re.from([255,192,0,17,8,t>>8,t,e>>8,e,3,0,0===n?33:34,0,1,17,1,2,17,1])}const ae=[0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],ce=[0,1,2,3,4,5,6,7,8,9,10,11],ue=[0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],le=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],he=[0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],de=[0,1,2,3,4,5,6,7,8,9,10,11],fe=[0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],pe=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function me(){const e=[[255,196,0,3+ae.length+ce.length,0],ae,ce],t=[[255,196,0,3+ue.length+le.length,16],ue,le],n=[[255,196,0,3+he.length+de.length,1],he,de],r=[[255,196,0,3+fe.length+pe.length,17],fe,pe];return re.concat([...e.map(re.from),...t.map(re.from),...n.map(re.from),...r.map(re.from)])}function ge(){return re.from([255,218,0,12,3,0,0,1,17,2,17,0,63,0])}function ye(e){return re.from([255,221,0,4,e>>8,255&e])}function be(e,t,n){return e>n?n:e<t?t:e}var ve=n(764).Buffer;const we=[16,11,12,14,12,10,16,14,13,14,18,17,16,19,24,40,26,24,22,22,24,49,35,37,29,40,58,51,61,60,57,51,56,55,64,72,92,78,64,68,87,69,55,56,80,109,81,87,95,98,103,104,103,62,77,113,121,112,100,120,92,101,103,99],_e=[17,18,18,24,21,24,47,26,26,47,99,66,56,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99];function Ee(e){const t=be(e,1,99),n=ve.alloc(128),r=e<50?Math.floor(5e3/t):200-2*t;for(let e=0;e<64;e++){const t=Math.floor((we[e]*r+50)/100),i=Math.floor((_e[e]*r+50)/100);n.writeUInt8(be(t,1,255),e),n.writeUInt8(be(i,1,255),e+64)}return n}var Se=n(764).Buffer;function Te(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=ie(),r=me(),i=ge();return function(o){let s;const a=[];for(const n of o){let r=x(n);const i=r.readUInt8(0),o=r.readUInt8(1)<<16|r.readUInt8(2)<<8|r.readUInt8(3),c=r.readUInt8(4),u=r.readUInt8(5),l=8*r.readUInt8(6)||e,h=8*r.readUInt8(7)||t;r=r.slice(8);let d=0;if(c>=64&&c<=127&&(d=r.readUInt16BE(0),r=r.slice(4)),u>=128&&0===o){const e=r.readUInt8(1),t=r.readUInt16BE(2);s={typeSpecific:i,type:c,width:l,height:h,DRI:d,precision:e,qTable:r.slice(4,4+t)},r=r.slice(4+t)}else u<128&&0===o&&(s={typeSpecific:i,type:c,width:l,height:h,DRI:d,precision:0,qTable:Ee(u)});a.push(r)}if(void 0===s)throw new Error("no quantization header present");const{precision:c,qTable:u,type:l,width:h,height:d}=s,f=oe(c,u),p=0===s.DRI?Se.alloc(0):ye(s.DRI),m=se(h,d,l);return{size:{width:h,height:d},data:Se.concat([n,f,p,m,r,i,...a])}}}class Re extends h{constructor(){let e,t,n=[];super(new o.Transform({objectMode:!0,transform:function(r,i,o){if(r.type===k.SDP){const n=r.sdp.media.find((e=>"video"===e.type&&void 0!==e.rtpmap&&"JPEG"===e.rtpmap.encodingName));if(void 0!==n&&void 0!==n.rtpmap){e=Number(n.rtpmap.payloadType);const r=n.framesize;if(void 0!==r){const[e,n]=r;t=Te(e,n)}else t=Te()}o(void 0,r)}else if(r.type===k.RTP&&w(r.data)===e){if(n.push(r.data),v(r.data)&&n.length>0){const e=t(n);this.push({timestamp:E(r.data),ntpTimestamp:r.ntpTimestamp,payloadType:w(r.data),data:e.data,framesize:e.size,type:k.JPEG}),n=[]}o()}else o(void 0,r)}}))}}var Ce=n(764).Buffer;function xe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class ke extends h{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:225e6;const t=new o.Transform({objectMode:!0,transform:(e,t,n)=>{this._active&&e.type===k.ISOM&&void 0!==e.tracks&&(this._capture=!0),this._capture&&e.type===k.ISOM&&(this._bufferOffset<this._buffer.byteLength-e.data.byteLength?(e.data.copy(this._buffer,this._bufferOffset),this._bufferOffset+=e.data.byteLength):this.stop()),n(void 0,e)}});t.on("finish",(()=>{this.stop()})),super(t),xe(this,"_active",void 0),xe(this,"_capture",void 0),xe(this,"_captureCallback",void 0),xe(this,"_bufferOffset",void 0),xe(this,"_bufferSize",void 0),xe(this,"_buffer",void 0),this._buffer=Ce.allocUnsafe(0),this._bufferSize=e,this._bufferOffset=0,this._active=!1,this._capture=!1,this._captureCallback=()=>{}}start(e){this._active||(F()("msl:capture:start")(e),this._captureCallback=e,this._buffer=Ce.allocUnsafe(this._bufferSize),this._bufferOffset=0,this._active=!0)}stop(){if(this._active){F()("msl:capture:stop")(`captured bytes: ${this._bufferOffset}`);try{this._captureCallback(this._buffer.slice(0,this._bufferOffset))}catch(e){console.error(e)}this._buffer=Ce.allocUnsafe(0),this._bufferOffset=0,this._active=!1,this._capture=!1}}}var Ie=n(764).Buffer;function Pe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Oe=Math.pow(2,32);class Be{constructor(e){Pe(this,"byteLength",void 0),Pe(this,"value",void 0),this.byteLength=e}}class Le extends Be{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0),Pe(this,"copy",((e,t)=>{e.fill(0,t,t+this.byteLength)}))}load(){}}class Ae extends Be{constructor(e){super(e.length),Pe(this,"value",void 0),Pe(this,"copy",((e,t)=>{for(let n=0;n<this.byteLength;n+=1)e[t+n]=this.value.charCodeAt(n)})),Pe(this,"load",((e,t)=>{this.value=e.slice(t,t+this.byteLength).toString("ascii")})),this.value=e}}class Me extends Be{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;super(1),Pe(this,"value",void 0),Pe(this,"copy",((e,t)=>{e.writeUInt8(this.value,t)})),Pe(this,"load",((e,t)=>{this.value=e.readUInt8(t)})),this.value=e}}class Ue extends Be{constructor(e){super(e.length),Pe(this,"value",void 0),Pe(this,"copy",((e,t)=>{for(let n=0;n<this.value.length;++n)e.writeUInt8(this.value[n],t+n)})),Pe(this,"load",((e,t)=>{for(let n=0;n<this.value.length;++n)this.value[n]=e.readUInt8(t+n)})),this.value=e}}class je extends Be{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;super(2),Pe(this,"value",void 0),Pe(this,"copy",((e,t)=>{e.writeUInt16BE(this.value,t)})),Pe(this,"load",((e,t)=>{this.value=e.readUInt16BE(t)})),this.value=e}}class De extends Be{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;super(3),Pe(this,"value",void 0),Pe(this,"copy",((e,t)=>{e.writeUInt8(this.value>>16&255,t),e.writeUInt8(this.value>>8&255,t+1),e.writeUInt8(255&this.value,t+2)})),Pe(this,"load",((e,t)=>{this.value=e.readUInt8(t)<<16+e.readUInt8(t+1)<<8+e.readUInt8(t+2)})),this.value=e}}class Ne extends Be{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;super(4),Pe(this,"value",void 0),Pe(this,"copy",((e,t)=>{e.writeUInt32BE(this.value,t)})),Pe(this,"load",((e,t)=>{this.value=e.readUInt32BE(t)})),this.value=e}}class Fe extends Be{constructor(e){super(4*e.length),Pe(this,"value",void 0),Pe(this,"copy",((e,t)=>{for(let n=0;n<this.value.length;++n)e.writeUInt32BE(this.value[n],t+4*n)})),Pe(this,"load",((e,t)=>{for(let n=0;n<this.value.length;++n)this.value[n]=e.readUInt32BE(t+4*n)})),this.value=e}}const qe=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return class extends Be{constructor(t){super(0),Pe(this,"value",void 0),Pe(this,"copy",((e,t)=>{let n=0;for(const r of this.value)r.copy(e,t+n),n+=r.byteLength})),Pe(this,"load",(()=>{})),this.value=t.reduce(((e,t)=>e.concat(new je(t.length),new Ue(t))),[new Me(e|t.length)]),this.byteLength=this.value.reduce(((e,t)=>e+t.byteLength),0)}}},He={ftyp:{container:"file",mandatory:!0,quantity:"one",box:"Box",is_container:!0,body:[["major_brand",Ae,"isom"],["minor_version",Ne,0],["compatible_brands",Ae,"mp41"]]},moov:{container:"file",mandatory:!0,quantity:"one",box:"Box",is_container:!0},mdat:{container:"file",mandatory:!1,quantity:"any",box:"Box",is_container:!1,body:[]},mvhd:{container:"moov",mandatory:!0,quantity:"one",box:"FullBox",is_container:!1,body:[["creation_time",Ne,0],["modification_time",Ne,0],["timescale",Ne,1e3],["duration",Ne,4294967295],["rate",Ne,65536],["volume",je,256],["reserved",Le,10],["matrix",Fe,[65536,0,0,0,65536,0,0,0,1073741824]],["pre_defined",Le,24],["next_track_ID",Ne,4294967295]]},trak:{container:"moov",mandatory:!0,quantity:"one+",box:"Box",is_container:!0},tkhd:{container:"trak",mandatory:!0,quantity:"one",box:"FullBox",is_container:!1,config:{flags:3},body:[["creation_time",Ne,0],["modification_time",Ne,0],["track_ID",Ne,1],["reserved",Le,4],["duration",Ne,0],["reserved2",Le,8],["layer",je,0],["alternate_group",je,0],["volume",je,256],["reserved3",Le,2],["matrix",Fe,[65536,0,0,0,65536,0,0,0,1073741824]],["width",Ne,0],["height",Ne,0]]},tref:{container:"trak",mandatory:!1,quantity:"one-",box:"Box",is_container:!1},mdia:{container:"trak",mandatory:!1,quantity:"one",box:"Box",is_container:!0},mdhd:{container:"mdia",mandatory:!1,quantity:"one",box:"FullBox",is_container:!1,body:[["creation_time",Ne,0],["modification_time",Ne,0],["timescale",Ne,1e3],["duration",Ne,4294967295],["language",je,0],["pre_defined",je,0]]},hdlr:{container:"mdia",mandatory:!0,quantity:"one",box:"FullBox",is_container:!1,body:[["predefined",Ne,0],["handler_type",Ae,"vide"],["reserved",Le,12],["name",Ae,"VideoHandler\0"]]},minf:{container:"mdia",mandatory:!0,quantity:"one",box:"Box",is_container:!0},vmhd:{container:"minf",mandatory:!0,quantity:"one",box:"FullBox",is_container:!1,config:{flags:1},body:[["graphicsmode",je,0],["opcolor",class extends Be{constructor(e){super(2*e.length),Pe(this,"value",void 0),Pe(this,"copy",((e,t)=>{for(let n=0;n<this.value.length;++n)e.writeUInt16BE(this.value[n],t+2*n)})),Pe(this,"load",((e,t)=>{for(let n=0;n<this.value.length;++n)this.value[n]=e.readUInt16BE(t+2*n)})),this.value=e}},[0,0,0]]]},smhd:{container:"minf",mandatory:!0,quantity:"one",box:"FullBox",is_container:!1,body:[["balance",je,0],["reserved",je]]},dinf:{container:"minf",mandatory:!0,quantity:"one",box:"Box",is_container:!0},dref:{container:"dinf",mandatory:!0,quantity:"one",box:"FullBox",is_container:!0,body:[["entry_count",Ne,0]]},"url ":{container:"dref",mandatory:!0,quantity:"one+",box:"FullBox",is_container:!1,config:{flags:1},body:[]},stbl:{container:"minf",mandatory:!0,quantity:"one",box:"Box",is_container:!0},stts:{container:"stbl",mandatory:!0,quantity:"one",box:"FullBox",is_container:!1,body:[["entry_count",Ne,0]]},stsd:{container:"stbl",mandatory:!0,quantity:"one",box:"FullBox",is_container:!0,body:[["entry_count",Ne,1]]},avc1:{container:"stsd",mandatory:!1,quantity:"one",box:"Box",is_container:!0,body:[["reserved",Le,6],["data_reference_index",je,1],["pre_defined",je,0],["reserved2",Le,2],["pre_defined2",Fe,[0,0,0]],["width",je,1920],["height",je,1080],["horizresolution",Ne,4718592],["vertresolution",Ne,4718592],["reserved3",Ne,0],["frame_count",je,1],["compressorname",Ue,Ie.alloc(32)],["depth",je,24],["pre_defined3",je,65535]]},avcC:{container:"avc1",mandatory:!1,quantity:"one",box:"Box",is_container:!1,body:[["configurationVersion",Me,1],["AVCProfileIndication",Me,77],["profile_compatibility",Me,0],["AVCLevelIndication",Me,41],["lengthSizeMinusOne",Me,255],["sequenceParameterSets",qe(224),[]],["pictureParameterSets",qe(),[]]]},mp4a:{container:"stsd",mandatory:!1,quantity:"one",box:"Box",is_container:!0,body:[["reserved",Le,6],["data_reference_index",je,1],["reserved2",Fe,[0,0]],["channelcount",je,2],["samplesize",je,16],["pre_defined",je,0],["reserved3",je,0],["samplerate",Ne,0]]},esds:{container:"mp4a",mandatory:!1,quantity:"one",box:"FullBox",is_container:!1,body:[["ES_DescrTag",Me,3],["ES_DescrLength",Me,25],["ES_ID",je,1],["flagsAndStreamPriority",Me,0],["DecoderConfigDescrTag",Me,4],["DecoderConfigDescrLength",Me,17],["objectProfileIndication",Me,64],["streamTypeUpstreamReserved",Me,21],["bufferSizeDB",Ue,[0,0,0]],["maxBitRate",Ne,0],["avgBitRate",Ne,0],["DecSpecificInfoShortTag",Me,5],["DecSpecificInfoShortLength",Me,2],["audioConfigBytes",je,0],["SLConfigDescrTag",Me,6],["SLConfigDescrLength",Me,1],["SLConfigDescrPredefined",Me,2]]},stsz:{container:"stbl",mandatory:!0,quantity:"one",box:"FullBox",is_container:!1,body:[["sample_size",Ne,0],["sample_count",Ne,0]]},stsc:{container:"stbl",mandatory:!0,quantity:"one",box:"FullBox",is_container:!1,body:[["entry_count",Ne,0]]},stco:{container:"stbl",mandatory:!0,quantity:"one",box:"FullBox",is_container:!1,body:[["entry_count",Ne,0]]},stss:{container:"stbl",mandatory:!1,quantity:"one-",box:"FullBox",is_container:!1,body:[["entry_count",Ne,0]]},edts:{container:"trak",mandatory:!1,quantity:"one-",box:"Box",is_container:!0},elst:{container:"edts",mandatory:!1,quantity:"one-",box:"FullBox",is_container:!1,body:[["entry_count",Ne,1],["segment_duration",Ne,0],["media_time",Ne,4294967295],["media_rate_integer",je,1],["media_rate_fraction",je,0]]},mvex:{container:"moov",mandatory:!1,quantity:"one-",box:"Box",is_container:!0},mehd:{container:"mvex",mandatory:!1,quantity:"one-",box:"FullBox",is_container:!1,body:[["fragment_duration",Ne,0]]},trex:{container:"mvex",mandatory:!0,quantity:"one+",box:"FullBox",is_container:!1,body:[["track_ID",Ne,1],["default_sample_description_index",Ne,1],["default_sample_duration",Ne,0],["default_sample_size",Ne,0],["default_sample_flags",Ne,0]]},moof:{container:"file",mandatory:!1,quantity:"zero+",box:"Box",is_container:!1},mfhd:{container:"moof",mandatory:!0,quantity:"one",box:"FullBox",is_container:!1,body:[["sequence_number",Ne,0]]},traf:{container:"moof",mandatory:!1,quantity:"zero+",box:"Box",is_container:!0},tfhd:{container:"traf",mandatory:!0,quantity:"one",box:"FullBox",is_container:!1,config:{flags:32},body:[["track_ID",Ne,1],["default_sample_flags",Ne,0]]},tfdt:{container:"traf",mandatory:!1,quantity:"one-",box:"FullBox",is_container:!1,config:{version:1},body:[["baseMediaDecodeTime",class extends Be{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;super(8),Pe(this,"value",void 0),Pe(this,"copy",((e,t)=>{const n=this.value/Oe|0,r=this.value-n*Oe;e.writeUInt32BE(n,t),e.writeUInt32BE(r,t+4)})),Pe(this,"load",((e,t)=>{const n=e.readUInt32BE(t),r=e.readUInt32BE(t+4);this.value=n*Oe+r})),this.value=e}},0]]},trun:{container:"traf",mandatory:!1,quantity:"zero+",box:"FullBox",is_container:!1,config:{flags:773},body:[["sample_count",Ne,1],["data_offset",Ne,0],["first_sample_flags",Ne,0],["sample_duration",Ne,0],["sample_size",Ne,0]]},"....":{box:"Box",is_container:!1,body:[]},file:{box:"None",is_container:!0,mandatory:!0,quantity:"one"}};class $e extends Be{constructor(e,t){super(0),Pe(this,"type",void 0),Pe(this,"config",void 0),Pe(this,"struct",void 0),this.type=e;const n=He[this.type];if(void 0===n)throw new Error(`unknown box type: ${e}`);this.config=Object.assign({},n.config,t);const r=class{static None(){return[]}static Box(e){return[["size",Ne,0],["type",Ae,e]]}static FullBox(e){return[].concat(this.Box(e),[["version",Me,0],["flags",De,0]])}}[n.box](this.type),i=n.body||[];this.struct=new Map;let o=0;for(const[e,t,n]of[].concat(r,i)){if(this.has(e))throw new Error("Trying to add existing key");let r=n;this.config[e]&&(r=this.config[e]);const i=new t(r);this.struct.set(e,{offset:o,element:i}),o+=i.byteLength}this.byteLength=o}element(e){const t=this.struct.get(e);if(void 0===t)throw new Error("invalid key");return t.element}set(e,t){this.element(e).value=t}get(e){return this.element(e).value}offset(e){const t=this.struct.get(e);if(void 0===t)throw new Error("invalid key");return t.offset}has(e){return this.struct.has(e)}add(e,t){if(this.has(e))throw new Error("Trying to add existing key");return this.struct.set(e,{offset:this.byteLength,element:t}),this.byteLength+=t.byteLength,this}buffer(){const e=Ie.allocUnsafe(this.byteLength);return this.copy(e),e}copy(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.set("size",this.byteLength);for(const n of this.struct.values())n.element.copy(e,t+n.offset)}load(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(const n of this.struct.values())void 0!==n.element.load&&n.element.load(e,t+n.offset)}format(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;const t=[" ".repeat(e)+`[${this.type}] (${this.byteLength})`];for(const[n,r]of this.struct){const i=r.element;void 0!==i.format?t.push(i.format(e+2)):t.push(" ".repeat(e+2)+`${n} = ${i.value} (${i.byteLength})`)}return t.join("\n")}print(e){console.warn(this.format(e))}}class We extends $e{constructor(e,t){super(e,t),Pe(this,"boxSize",void 0),this.boxSize=0;for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];this.append(...r)}append(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(const e of t)this.add("box_"+this.boxSize++,e);return this}parse(e){const t=[];for(;e.byteLength>0;){const n=new Ae("....");n.load(e,4);const r=n.value,i=He[r];let o;if(void 0!==i){if(i.is_container){o=new We(r),o.load(e);const n=o.parse(e.slice(o.byteLength,o.get("size")));t.push(...n)}else if(o=new $e(r),o.load(e),"avcC"===r){const e=o.element("AVCProfileIndication").value.toString(16).padStart(2,0),n=o.element("profile_compatibility").value.toString(16).padStart(2,0),r=o.element("AVCLevelIndication").value.toString(16).padStart(2,0);t.push({type:"video",mime:`avc1.${e}${n}${r}`})}else if("esds"===r){const e=o.element("audioConfigBytes").value>>>11&31;t.push({type:"audio",mime:`mp4a.40.${e}`})}}else o=new $e("...."),o.load(e),o.type=o.get("type");this.append(o),e=e.slice(o.get("size"))}return t}}const ze={1:"AAC Main",2:"AAC LC"},Ve={0:"96 kHz",1:"88.2 kHz",2:"64 kHz",3:"48 kHz",4:"44.1 kHz",5:"32 kHz",6:"24 kHz",7:"22.05 kHz",8:"16 kHz",9:"12 kHz",10:"11.025 kHz",11:"8 kHz",12:"7.35 kHz"},Ge={1:"Mono",2:"Stereo"},Ye=e=>{const t=e>>>11&31,n=e>>>3&15;return{coding:ze[t]||`AAC (${t})`,samplingRate:Ve[e>>>7&15]||"unknown",channels:Ge[n]||n.toString()}};function Je(e,t){const n=e.replace(/[^A-Za-z0-9+/]/g,""),r=n.length,i=t?Math.ceil((3*r+1>>2)/t)*t:3*r+1>>2,o=new Uint8Array(i);let s,a,c=0,u=0;for(let e=0;e<r;e++)if(a=3&e,c|=((l=n.charCodeAt(e))>64&&l<91?l-65:l>96&&l<123?l-71:l>47&&l<58?l+4:43===l?62:47===l?63:0)<<18-6*a,3===a||r-e==1){for(s=0;s<3&&u<i;s++,u++)o[u]=c>>>(16>>>s&24)&255;c=0}var l;return o}function Ke(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Xe{constructor(e){Ke(this,"_buffer",void 0),Ke(this,"_dataView",void 0),Ke(this,"_offset",void 0),Ke(this,"_bitpos",void 0),Ke(this,"_byte",void 0),this._buffer=e,this._dataView=new DataView(this._buffer),this._offset=0,this._bitpos=0,this._byte=0}readUint8(e){return this._dataView.getUint8(e)}readUint16(e){return this._dataView.getUint16(e)}readUint32(e){return this._dataView.getUint32(e)}readNext(){const e=this.readUint8(this._offset);return this._offset+=1,e}readBits(e){if(e>32||0===e)throw new Error("length has to be between 0 - 31 bits");let t=0;for(let n=1;n<=e;++n)0===this._bitpos&&(this._byte=this.readNext()),t=t<<1|this._byte>>8-++this._bitpos&1,this._bitpos%=8;return t}readUnsignedExpGolomb(){let e=0;for(;1!==this.readBits(1);)e++;if(0===e)return 0;if(e>=31)throw new Error("read unsigned exponential Golomb: internal error");let t=this.readBits(e);return t|=1<<e,t-1}readSignedExpGolomb(){let e=this.readUnsignedExpGolomb();return e=1&e?e+1>>1:-(e>>1),e}size(){return this._buffer.byteLength}getUint8Array(){return new Uint8Array(this._buffer)}getArrayBuffer(){return this._buffer}}class Ze{constructor(e){var t,n;n=void 0,(t="reader")in this?Object.defineProperty(this,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):this[t]=n,this.reader=new Xe(e)}parse(){this.reader.readNext();const e=this.reader.readNext();this.reader.readNext();const t=this.reader.readNext();if(this.reader.readUnsignedExpGolomb(),[100,110,122,244,44,83,86,118].includes(e)){const e=this.reader.readUnsignedExpGolomb();if(3===e&&this.reader.readBits(1),this.reader.readUnsignedExpGolomb(),this.reader.readUnsignedExpGolomb(),this.reader.readBits(1),this.reader.readBits(1))for(let t=0;t<(3!==e?8:12);t++)this.reader.readBits(1)}this.reader.readUnsignedExpGolomb();const n=this.reader.readUnsignedExpGolomb();if(0===n)this.reader.readUnsignedExpGolomb();else if(1===n){let e=0;this.reader.readBits(1),this.reader.readSignedExpGolomb(),this.reader.readSignedExpGolomb(),e=this.reader.readUnsignedExpGolomb();for(let t=0;t<e;t++)this.reader.readSignedExpGolomb()}this.reader.readUnsignedExpGolomb(),this.reader.readBits(1);const r=this.reader.readUnsignedExpGolomb(),i=this.reader.readUnsignedExpGolomb(),o=this.reader.readBits(1);this.reader.readBits(1);const s=this.reader.readBits(1);return{profile:e,level:t/10,width:16*(r+1)-2*(s?this.reader.readUnsignedExpGolomb():0)-2*(s?this.reader.readUnsignedExpGolomb():0),height:(2-o)*(i+1)*16-2*(s?this.reader.readUnsignedExpGolomb():0)-2*(s?this.reader.readUnsignedExpGolomb():0)}}}const Qe={66:"Baseline",77:"Main",100:"High"},et=e=>{const t=parseInt(e.substr(0,2),16),n=parseInt(e.substr(4,2),16);return{coding:"H.264",profile:Qe[t]||t.toString(),level:(n/10).toFixed(1)}};function tt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const nt={"MPEG4-GENERIC":(e,t,n)=>{const r=Number(e.fmtp.parameters.bitrate)||32e4,i=parseInt(e.fmtp.parameters.config,16),o=i>>>11&31;return{tkhd:{track_ID:n,creation_time:t,modification_time:t,width:0,height:0,volume:1},mdhd:{timescale:Number(e.rtpmap.clockrate),creation_time:t,modification_time:t,duration:0},hdlr:{handler_type:"soun",name:"SoundHandler\0"},mediaHeaderBox:new $e("smhd"),sampleEntryBox:new We("mp4a",{samplerate:e.rtpmap.clockrate<<16>>>0},new $e("esds",{audioConfigBytes:i,maxBitRate:r,avgBitRate:r})),defaultFrameDuration:1024,mime:`mp4a.40.${o}`,codec:Ye(i)}},H264:(e,t,n)=>{const r=e.fmtp.parameters["profile-level-id"]??"4d0029",i=e.fmtp.parameters["sprop-parameter-sets"].split(",").map(Je),o=i.slice(0,1),s=i.slice(1),a=new Ze(o[0].buffer).parse();return{mediaHeaderBox:new $e("vmhd"),sampleEntryBox:new We("avc1",{width:a.width,height:a.height},new $e("avcC",{AVCProfileIndication:o[0][1],profile_compatibility:o[0][2],AVCLevelIndication:o[0][3],sequenceParameterSets:o,pictureParameterSets:s})),tkhd:{track_ID:n,creation_time:t,modification_time:t,width:a.width<<16,height:a.height<<16,volume:0},hdlr:{},mdhd:{timescale:e.rtpmap.clockrate,creation_time:t,modification_time:t,duration:0},defaultFrameDuration:void 0!==e.framerate&&e.framerate>0&&Number(e.rtpmap.clockrate)/Number(e.framerate)||3600,mime:`avc1.${r}`,codec:et(r)}}};class rt{constructor(){tt(this,"trackIdMap",void 0),tt(this,"sequenceNumber",void 0),tt(this,"ntpPresentationTime",void 0),tt(this,"trackData",void 0),tt(this,"videoTrackId",void 0),this.trackIdMap={},this.sequenceNumber=0,this.ntpPresentationTime=0,this.trackData=[]}trak(e){const t=new We("trak"),n=new We("mdia"),r=new We("minf"),i=new We("dinf"),o=new We("dref"),s=new We("stbl");return o.set("entry_count",1),t.append(new $e("tkhd",e.tkhd),n.append(new $e("mdhd",e.mdhd),new $e("hdlr",e.hdlr),r.append(e.mediaHeaderBox,i.append(o.append(new $e("url "))),s.append(new We("stsd",void 0,e.sampleEntryBox),new $e("stts"),new $e("stsc"),new $e("stco"),new $e("stsz"),new $e("stss"))))),t}moov(e,t){const n=new We("moov");n.append(new $e("mvhd",{creation_time:t,modification_time:t,duration:0}));const r=new We("mvex");this.trackIdMap={},this.sequenceNumber=0,this.ntpPresentationTime=0;let i=0;return this.trackData=[],e.media.forEach((e=>{if(void 0===e.rtpmap)return;const o=e.rtpmap.payloadType,s=e.rtpmap.encodingName;if(void 0!==nt[s]){this.trackIdMap[o]=++i,"video"===e.type.toLowerCase()&&(this.videoTrackId=i);const a=nt[s](e,t,i);e.mime=a.mime,e.codec=a.codec;const c={lastTimestamp:0,baseMediaDecodeTime:0,defaultFrameDuration:0,clockrate:0,bitrate:0,framerate:0,cumulativeByteLength:0,cumulativeDuration:0,cumulativeFrames:0};c.clockrate=e.rtpmap.clockrate,c.defaultFrameDuration=a.defaultFrameDuration,this.trackData.push(c);const u=this.trak(a);n.append(u),r.append(new $e("trex",{track_ID:i}))}})),n.append(r),n}moof(e){const{trackId:t,timestamp:n,byteLength:r}=e,i=t-1,o=this.trackData[i],s=0!==o.lastTimestamp?n-o.lastTimestamp|0:o.defaultFrameDuration;o.lastTimestamp=n;const a=new We("moof"),c=new We("traf"),u=new $e("trun",{sample_duration:s,sample_size:r,first_sample_flags:64});return a.append(new $e("mfhd",{sequence_number:this.sequenceNumber++}),c.append(new $e("tfhd",{track_ID:t}),new $e("tfdt",{baseMediaDecodeTime:o.baseMediaDecodeTime}),u)),o.baseMediaDecodeTime+=s,u.set("data_offset",a.byteLength+8),((e,t)=>{let{byteLength:n,duration:r}=t;if(e.cumulativeByteLength+=n,e.cumulativeDuration+=r,e.cumulativeFrames++,e.cumulativeDuration>=e.clockrate){const t=8*e.cumulativeByteLength,n=e.cumulativeFrames,r=e.cumulativeDuration/e.clockrate;e.bitrate=t/r,e.framerate=n/r,e.cumulativeByteLength=0,e.cumulativeDuration=0,e.cumulativeFrames=0}})(o,{byteLength:r,duration:s}),a}mdat(e){const t=new $e("mdat");return t.add("data",e),t}setPresentationTime(e,t){if(!this.ntpPresentationTime&&t&&e===this.videoTrackId){const n=e-1,r=this.trackData[n];this.ntpPresentationTime=t-r.baseMediaDecodeTime/r.clockrate*1e3}}}var it=n(764).Buffer;function ot(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class st extends h{constructor(){const e=new rt,t=e=>{this.onSync&&this.onSync(e)},n=new o.Transform({objectMode:!0,transform:function(n,r,i){if(n.type===k.SDP){const t=Math.floor((new Date).getTime()/1e3+2082852e3),r=new $e("ftyp"),i=e.moov(n.sdp,t),o=it.allocUnsafe(r.byteLength+i.byteLength);r.copy(o,0),i.copy(o,r.byteLength),F()("msl:mp4:isom")(`ftyp: ${r.format()}`),F()("msl:mp4:isom")(`moov: ${i.format()}`);const s=n.sdp.media.map((e=>({type:e.type,encoding:e.rtpmap&&e.rtpmap.encodingName,mime:e.mime,codec:e.codec})));this.push({type:k.ISOM,data:o,tracks:s,ftyp:r,moov:i})}else if(n.type===k.ELEMENTARY||n.type===k.H264){const{payloadType:r,timestamp:i,ntpTimestamp:o}=n,s=e.trackIdMap[r];if(s){let r;e.ntpPresentationTime||(e.setPresentationTime(s,o),e.ntpPresentationTime&&t(e.ntpPresentationTime));const a=n.type===k.H264?n.nalType===H.IDR_PICTURE:void 0;e.ntpPresentationTime&&a&&void 0!==n.ntpTimestamp&&(r=(n.ntpTimestamp-e.ntpPresentationTime)/1e3);const c=n.data.byteLength,u=e.moof({trackId:s,timestamp:i,byteLength:c}),l=e.mdat(n.data),h=it.allocUnsafe(u.byteLength+l.byteLength);u.copy(h,0),l.copy(h,u.byteLength),this.push({type:k.ISOM,data:h,moof:u,mdat:l,ntpTimestamp:o,checkpointTime:r})}}else this.push(n);i()}});super(n),ot(this,"boxBuilder",void 0),ot(this,"onSync",void 0),this.boxBuilder=e}get bitrate(){return this.boxBuilder.trackData&&this.boxBuilder.trackData.map((e=>e.bitrate))}get framerate(){return this.boxBuilder.trackData&&this.boxBuilder.trackData.map((e=>e.framerate))}get ntpPresentationTime(){return this.boxBuilder.ntpPresentationTime}}function at(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ct(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?at(Object(n),!0).forEach((function(t){ut(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):at(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ut(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}let lt;!function(e){e[e.SR=200]="SR",e[e.RR=201]="RR",e[e.SDES=202]="SDES",e[e.BYE=203]="BYE",e[e.APP=204]="APP"}(lt||(lt={}));const ht=e=>{const t=(e=>({version:e[0]>>>6,padding:!!(e[0]&f[2]),count:31&e[0],packetType:e.readUInt8(1),length:e.readUInt16BE(2)}))(e);switch(t.packetType){case lt.SR:return mt(e,t);case lt.RR:return yt(e,t);case lt.SDES:return wt(e,t);case lt.BYE:return Et(e,t);case lt.APP:return Tt(e,t);default:return t}},dt=(e,t)=>({type:k.RTCP,data:t,channel:e,rtcp:ht(t)}),ft={packetType:200},pt=(e,t,n)=>{const r=[];for(let i=0;i<e;i++){const e=n+24*i;r.push({syncSource:t.readUInt32BE(e+0),fractionLost:t.readUInt8(e+4),cumulativeNumberOfPacketsLost:t.readUIntBE(e+5,3),extendedHighestSequenceNumberReceived:t.readUInt32BE(e+8),interarrivalJitter:t.readUInt32BE(e+12),lastSRTimestamp:t.readUInt32BE(e+16),delaySinceLastSR:t.readUInt32BE(e+20)})}return r},mt=(e,t)=>ct(ct({},t),{},{syncSource:e.readUInt32BE(4),ntpMost:e.readUInt32BE(8),ntpLeast:e.readUInt32BE(12),rtpTimestamp:e.readUInt32BE(16),sendersPacketCount:e.readUInt32BE(20),sendersOctetCount:e.readUInt32BE(24),reports:pt(t.count,e,28)}),gt=e=>e.packetType===lt.SR,yt=(e,t)=>ct(ct({},t),{},{syncSource:e.readUInt32BE(4),reports:pt(t.count,e,8)}),bt=e=>e.packetType===lt.RR;let vt;!function(e){e[e.CNAME=1]="CNAME",e[e.NAME=2]="NAME",e[e.EMAIL=3]="EMAIL",e[e.PHONE=4]="PHONE",e[e.LOC=5]="LOC",e[e.TOOL=6]="TOOL",e[e.NOTE=7]="NOTE",e[e.PRIV=8]="PRIV"}(vt||(vt={}));const wt=(e,t)=>{const n=[];let r=4;for(let i=0;i<t.count;i++){const t={source:e.readUInt32BE(r),items:[]};for(r+=4;;){const n=e.readUInt8(r++);if(0===n){r%4!=0&&(r+=4-r%4);break}const i=e.readUInt8(r++);if(n===vt.PRIV){const n=e.readUInt8(r),o=e.toString("utf8",r+1,r+1+n),s=e.toString("utf8",r+1+n,r+i);t.items.push([vt.PRIV,o,s])}else{const o=e.toString("utf8",r,r+i);t.items.push([n,o])}r+=i}n.push(t)}return ct(ct({},t),{},{syncSource:e.readUInt32BE(4),sourceDescriptions:n})},_t=e=>e.packetType===lt.SDES,Et=(e,t)=>{const n=[];for(let r=0;r<t.count;r++)n.push(e.readUInt32BE(4+4*r));let r;if(t.length>t.count){const n=4+4*t.count,i=e.readUInt8(n);r=e.toString("utf-8",n+1,n+1+i)}return ct(ct({},t),{},{sources:n,reason:r})},St=e=>e.packetType===lt.BYE,Tt=(e,t)=>ct(ct({},t),{},{subtype:t.count,source:e.readUInt32BE(4),name:e.toString("ascii",8,12),data:e.slice(12)}),Rt=e=>e.packetType===lt.APP;function Ct(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const xt=F()("msl:mse");class kt extends d{constructor(e){if(void 0===e)throw new Error("video element argument missing");let t,n;const r=new o.Writable({objectMode:!0,write:(i,o,s)=>{if(i.type===k.ISOM)if(this._done=s,void 0!==i.tracks||void 0!==i.mime){const o=i.tracks??[],s=o.map((e=>e.mime)).filter((e=>e)),a=0!==s.length?s.join(", "):"avc1.640029, mp4a.40.2",c=i.mime??`video/mp4; codecs="${a}"`;if(!MediaSource.isTypeSupported(c))return void r.emit("error",`unsupported media type: ${c}`);this._lastCheckpointTime=0,t=new MediaSource,e.src=window.URL.createObjectURL(t);const u=()=>{if(void 0!==t){window.URL.revokeObjectURL(e.src),t.removeEventListener("sourceopen",u),this.onSourceOpen&&this.onSourceOpen(t,o),n=this.addSourceBuffer(e,t,c),n.onerror=e=>{console.error("error on SourceBuffer: ",e),r.emit("error")};try{n.appendBuffer(i.data)}catch(e){xt("failed to append to SourceBuffer: ",e,i)}}else r.emit("error","no MediaSource instance")};t.addEventListener("sourceopen",u)}else{this._lastCheckpointTime=void 0!==i.checkpointTime?i.checkpointTime:this._lastCheckpointTime;try{var a;null===(a=n)||void 0===a||a.appendBuffer(i.data)}catch(e){xt("failed to append to SourceBuffer: ",e,i)}}else if(i.type===k.RTCP){var c;St(i.rtcp)&&"open"===(null===(c=t)||void 0===c?void 0:c.readyState)&&t.endOfStream(),s()}else s()}});r.on("finish",(()=>{console.warn("incoming stream finished: end stream"),t&&"open"===t.readyState&&t.endOfStream()})),r.on("error",(e=>{var r;console.error("error on incoming stream: ",e),n&&n.updating?n.addEventListener("updateend",(()=>{var e;"open"===(null===(e=t)||void 0===e?void 0:e.readyState)&&t.endOfStream()})):"open"===(null===(r=t)||void 0===r?void 0:r.readyState)&&t.endOfStream()}));const i=new o.Readable({objectMode:!0,read:function(){}});i.on("error",(()=>{console.warn("outgoing stream broke somewhere")})),super(r,i),Ct(this,"_videoEl",void 0),Ct(this,"_done",void 0),Ct(this,"_lastCheckpointTime",void 0),Ct(this,"onSourceOpen",void 0),this._videoEl=e,this._lastCheckpointTime=0}addSourceBuffer(e,t,n){const r=t.addSourceBuffer(n);let i=0;return r.addEventListener("updateend",(()=>{if(++i,i>100&&r.buffered.length){i=0;const t=r.buffered.length-1,n=r.buffered.start(t),o=Math.min(e.currentTime,this._lastCheckpointTime)-10;try{if(o>n)return void r.remove(n,o)}catch(e){console.warn(e)}}this._done&&this._done()})),r}get currentTime(){return this._videoEl.currentTime}async play(){return await this._videoEl.play()}pause(){return this._videoEl.pause()}}var It=n(764).Buffer;class Pt extends h{constructor(){let e,t=[];super(new o.Transform({objectMode:!0,transform:function(n,r,i){if(n.type===k.SDP){let t;for(const e of n.sdp.media)"application"===e.type&&e.rtpmap&&"VND.ONVIF.METADATA"===e.rtpmap.encodingName&&(t=e);t&&t.rtpmap&&(e=Number(t.rtpmap.payloadType)),i(void 0,n)}else if(n.type===k.RTP&&w(n.data)===e){if(t.push(x(n.data)),v(n.data)&&t.length>0)return i(void 0,{timestamp:E(n.data),ntpTimestamp:n.ntpTimestamp,payloadType:w(n.data),data:It.concat(t),type:k.XML}),void(t=[]);i()}else i(void 0,n)}}))}}var Ot=n(764).Buffer;const Bt=e=>e.match(/^m=/),Lt=(e,t)=>{const n=t.indexOf(e);return n<0?[t.slice(0)]:[t.slice(0,n),t.slice(n+1)]},At={fmtp:e=>{const[t,n]=Lt(" ",e);{const e=n.trim().split(";"),r={};return e.forEach((e=>{const[t,n]=Lt("=",e),i=t.trim().toLowerCase();""!==i&&(r[i]=n.trim())})),{format:t,parameters:r}}},framerate:Number,rtpmap:e=>{const[t,n]=Lt(" ",e),[r,i,o]=n.toUpperCase().split("/");return void 0===o?{payloadType:Number(t),encodingName:r,clockrate:Number(i)}:{payloadType:Number(t),encodingName:r,clockrate:Number(i),encodingParameters:o}},transform:e=>e.split(";").map((e=>e.split(",").map(Number))),"x-sensor-transform":e=>e.split(";").map((e=>e.split(",").map(Number))),framesize:e=>e.split(" ")[1].split("-").map(Number)},Mt=e=>{const t=e.slice(0,1),n=e.slice(2);switch(t){case"v":return{version:n};case"o":const[e,t,r,i,o,s]=n.split(" ");return{origin:{addrType:o,netType:i,sessionId:t,sessionVersion:r,unicastAddress:s,username:e}};case"s":return{sessionName:n};case"i":return{sessionInformation:n};case"u":return{uri:n};case"e":return{email:n};case"p":return{phone:n};case"c":const[a,c,u]=n.split(" ");return{connectionData:{addrType:c,connectionAddress:u,netType:a}};case"b":const[l,h]=n.split(":");return{bwtype:l,bandwidth:h};case"t":const[d,f]=n.split(" ").map(Number);return{time:{startTime:d,stopTime:f}};case"r":const[p,m,...g]=n.split(" ").map(Number);return{repeatTimes:{repeatInterval:p,activeDuration:m,offsets:g}};case"z":case"k":return;case"a":return(e=>{const[t,n]=Lt(":",e);return void 0===n?{[t]:!0}:void 0!==At[t]?{[t]:At[t](n)}:{[t]:n}})(n);case"m":const[y,b,v,w]=n.split(" ");return{type:y,port:Number(b),protocol:v,fmt:Number(w)}}},Ut=e=>{const t=e.indexOf("\nm=");return function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r=`\n${t}`;n=e.indexOf(r,n);let i=0;const o=[];for(;n>=0;)i=e.indexOf("\n",n+r.length),o.push(e.toString("ascii",n+r.length,i).trim()),n=e.indexOf(r,i);return o}(e,"a=control:",t)},jt=e=>{const t=e.toString("ascii").split("\n").map((e=>e.trim())),n={session:{},media:[]};let r=0,i=n.session;for(const e of t)Bt(e)&&(n.media[r]={},i=n.media[r],++r),i=Object.assign(i,Mt(e));return n},Dt=e=>({type:k.SDP,data:e,sdp:jt(e)}),Nt=(e,t)=>{const n=`\n${t.toLowerCase()}: `,r=e.toString().toLowerCase().indexOf(n);if(r>=0){const t=e.indexOf("\n",r+n.length);return e.toString("ascii",r+n.length,t).trim()}return null},Ft=e=>{const t=Nt(e,"CSeq");return null!==t?Number(t):null},qt=e=>{const t=Nt(e,"Session");return t?t.split(";")[0]:null},Ht=e=>{const t=Nt(e,"Session");if(null===t)return null;const n="timeout=",r=t.toLowerCase().indexOf(n);if(-1!==r){let e=t.substring(r+n.length);e=e.split(";")[0];const i=parseInt(e);return isNaN(i)?60:i}return 60},$t=e=>Number(e.toString("ascii",9,12)),Wt=e=>Nt(e,"Content-Base"),zt=e=>Nt(e,"Content-Location"),Vt=e=>{const t=Nt(e,"Connection");return null!==t&&"close"===t.toLowerCase()},Gt=e=>{const t=Nt(e,"Range");if(null!==t)return t.split("=")[1].split("-")},Yt=e=>{const t=["\n\n","\r\r","\r\n\r\n"].map((t=>{const n=e.indexOf(t);return-1!==n?n+t.length:n})).filter((e=>-1!==e));return t.length>0?t.reduce(((e,t)=>Math.min(e,t))):-1};var Jt,Kt=n(764).Buffer;function Xt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(e){e[e.IDLE=0]="IDLE",e[e.INTERLEAVED=1]="INTERLEAVED",e[e.RTSP=2]="RTSP"}(Jt||(Jt={}));class Zt{constructor(){Xt(this,"_chunks",[]),Xt(this,"_length",0),Xt(this,"_state",Jt.IDLE),Xt(this,"_packet",void 0),this._init()}_init(){this._chunks=[],this._length=0,this._state=Jt.IDLE}_push(e){this._chunks.push(e),this._length+=e.length}_parseRtsp(){const e=[],t=Kt.concat(this._chunks),n=Yt(t);if(-1===n)return e;const r=n,i=Nt(t,"Content-Length");if(i&&parseInt(i)>t.length-r)return e;if(this._init(),r===t.length||36===t[r]){const n=t.slice(0,r);e.push({type:k.RTSP,data:n});const i=t.slice(r);this._push(i)}else{const n=t,i=t.slice(r);e.push({type:k.RTSP,data:n}),e.push(Dt(i))}return e}_parseInterleaved(){const e=[];if(this._length<4)return e;if(this._packet||(this._packet=(e=>{const t=Kt.alloc(4);let n=0,r=0;for(;r<t.length;){const i=e[n++],o=Math.min(i.length,t.length-r);i.copy(t,r,0,o),r+=o}const i=t[1],o=t.length;return{channel:i,begin:o,end:o+t.readUInt16BE(2)}})(this._chunks)),this._length<this._packet.end)return e;const t=Kt.concat(this._chunks),n=t.slice(this._packet.begin,this._packet.end),r=t.slice(this._packet.end),i=this._packet.channel;if(delete this._packet,this._init(),this._push(r),i%2==0)e.push({type:k.RTP,data:n,channel:i});else{let t=n;do{const n=4*t.readUInt16BE(2)+4;e.push(dt(i,t.slice(0,n))),t=t.slice(n)}while(t.length>0)}return e}_setState(){for(;this._chunks.length>0&&0===this._chunks[0].length;)this._chunks.shift();const e=this._chunks[0];if(0===this._chunks.length)this._state=Jt.IDLE;else if(36===e[0])this._state=Jt.INTERLEAVED;else{if("RTSP"!==e.toString("ascii",0,4))throw new Error(`Unknown chunk of length ${e.length}`);this._state=Jt.RTSP}}parse(e){this._push(e),this._state===Jt.IDLE&&this._setState();let t=[],n=!1;for(;!n;){let e=[];switch(this._state){case Jt.IDLE:break;case Jt.INTERLEAVED:e=this._parseInterleaved();break;case Jt.RTSP:e=this._parseRtsp();break;default:throw new Error("internal error: unknown state")}e.length>0?t=t.concat(e):n=!0,this._setState()}return t}}class Qt extends h{constructor(){const e=new Zt,t=new o.Transform({objectMode:!0,transform:function(n,r,i){if(n.type===k.RAW)try{e.parse(n.data).forEach((e=>t.push(e))),i()}catch(e){i(e)}else i(void 0,n)}}),n=new o.Transform({objectMode:!0,transform:function(e,t,n){if(e.type===k.RTSP){const t=(e=>{if(!e.method||!e.uri)throw new Error("message needs to contain a method and a uri");const t=e.protocol||"RTSP/1.0",n=e.headers||{},r=[`${e.method} ${e.uri} ${t}`,Object.entries(n).map((e=>{let[t,n]=e;return t+": "+n})).join("\r\n"),"\r\n"].join("\r\n");return F()("msl:rtsp:outgoing")(r),Ot.from(r)})(e);n(void 0,{type:k.RAW,data:t})}else n(void 0,e)}});super(t,n)}}const en=(e,t)=>{let n;if(void 0!==t){if("object"!=typeof t)throw new Error("merge expects override to be an object!");n=Object.keys(t).reduce(((e,n)=>(void 0!==t[n]&&(e[n]=t[n]),e)),{})}return Object.assign({},e,n)},tn=Date.UTC(1900,0,1);function nn(e,t){return tn+1e3*(e+t/4294967296)}var rn,on=n(764).Buffer;function sn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}let an;!function(e){e.IDLE="idle",e.PLAYING="playing",e.PAUSED="paused"}(rn||(rn={})),function(e){e.OPTIONS="OPTIONS",e.DESCRIBE="DESCRIBE",e.SETUP="SETUP",e.PLAY="PLAY",e.PAUSE="PAUSE",e.TEARDOWN="TEARDOWN"}(an||(an={}));class cn extends Error{constructor(e,t){super(e),sn(this,"code",void 0),this.name="RTSPResponseError",this.code=t}}class un extends h{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{uri:t,headers:n,defaultHeaders:r}=en(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"undefined"==typeof window?"":window.location.hostname,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return{uri:t.length>0?`rtsp://${e}/axis-media/media.amp?${t.join("&")}`:`rtsp://${e}/axis-media/media.amp`}}(e.hostname,e.parameters),e),i=new o.Transform({objectMode:!0,transform:(e,t,n)=>{e.type===k.RTSP?(this._onRtsp(e),n()):e.type===k.RTCP?(this._onRtcp(e),this.onRtcp&&this.onRtcp(e.rtcp),n(void 0,e)):e.type===k.RTP?(this._onRtp(e),n(void 0,e)):e.type===k.SDP?(this._onSdp(e),this.onSdp&&this.onSdp(e.sdp),n(void 0,e)):n(void 0,e)}});i.on("end",(()=>{this._outgoingClosed=!0})),super(i),sn(this,"uri",void 0),sn(this,"headers",void 0),sn(this,"defaultHeaders",void 0),sn(this,"t0",void 0),sn(this,"n0",void 0),sn(this,"clockrates",void 0),sn(this,"startTime",void 0),sn(this,"onRtcp",void 0),sn(this,"onSdp",void 0),sn(this,"onError",void 0),sn(this,"onPlay",void 0),sn(this,"retry",void 0),sn(this,"_outgoingClosed",void 0),sn(this,"_sequence",void 0),sn(this,"_callStack",void 0),sn(this,"_callHistory",void 0),sn(this,"_state",void 0),sn(this,"_waiting",void 0),sn(this,"_contentBase",void 0),sn(this,"_contentLocation",void 0),sn(this,"_sessionId",void 0),sn(this,"_sessionControlURL",void 0),sn(this,"_renewSessionInterval",void 0),this._outgoingClosed=!1,this._reset(),this.update(t,n,r),this._sessionControlURL=this._controlURL()}update(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(void 0===e)throw new Error("You must supply an uri when creating a RtspSessionComponent");this.uri=e,this.defaultHeaders=n,this.headers=Object.assign({[an.OPTIONS]:{},[an.PLAY]:{},[an.SETUP]:{Blocksize:"64000"},[an.DESCRIBE]:{Accept:"application/sdp"},[an.PAUSE]:{}},t)}_reset(){this._sequence=1,this.retry=()=>console.error("No request sent, can't retry"),this._callStack=[],this._callHistory=[],this._state=rn.IDLE,this._waiting=!1,this._contentBase=null,this._sessionId=null,null!==this._renewSessionInterval&&clearInterval(this._renewSessionInterval),this._renewSessionInterval=null,this.t0=void 0,this.n0=void 0,this.clockrates=void 0}_controlURL(e){if(void 0!==e&&/^[^:]+:\/\//.test(e))return e;const t=this._contentBase??this._contentLocation??this.uri;if(null==t)throw new Error("relative or missing control attribute but no base URL available");return void 0===e||"*"===e?t:new URL(e,t).href}_onRtsp(e){this._waiting=!1;const t=$t(e.data),n=Vt(e.data),r=Ft(e.data);if(null===r)throw new Error("rtsp: expected sequence number");if(void 0===this._callHistory)throw new Error("rtsp: internal error");const i=this._callHistory[r-1];if(F()("msl:rtsp:incoming")(`${e.data}`),!this._sessionId&&!n){this._sessionId=qt(e.data);const t=Ht(e.data);null!==t&&(null!==this._renewSessionInterval&&clearInterval(this._renewSessionInterval),this._renewSessionInterval=setInterval((()=>{this._enqueue({method:an.OPTIONS}),this._dequeue()}),1e3*Math.max(5,t-5)))}this._contentBase||(this._contentBase=Wt(e.data)),this._contentLocation||(this._contentLocation=zt(e.data)),t>=400&&this.onError&&this.onError(new cn(e.data.toString("ascii"),t)),i===an.PLAY&&this.onPlay&&this.onPlay(Gt(e.data)),n&&(F()("msl:rtsp:incoming")(`RTSP Session ${this._sessionId} ended with statusCode: ${t}`),this._sessionId=null),this._dequeue()}_onRtcp(e){if(void 0===this.t0||void 0===this.n0)throw new Error("rtsp: internal error");if(gt(e.rtcp)){const t=e.channel-1;this.t0[t]=e.rtcp.rtpTimestamp,this.n0[t]=nn(e.rtcp.ntpMost,e.rtcp.ntpLeast)}}_onRtp(e){if(void 0===this.t0||void 0===this.n0||void 0===this.clockrates)throw new Error("rtsp: internal error");const t=e.channel,n=this.t0[t],r=this.n0[t];if(void 0!==n&&void 0!==r){const i=this.clockrates[t],o=E(e.data)-n|0;e.ntpTimestamp=o/i*1e3+r}}_onSdp(e){this.n0={},this.t0={},this.clockrates={},this._sessionControlURL=this._controlURL(e.sdp.session.control),e.sdp.media.forEach(((e,t)=>{if(void 0===e.rtpmap)return;const{clockrate:n}=e.rtpmap,r=2*t,i=r+1,o=void 0===e.control?this._sessionControlURL:this._controlURL(e.control);this._enqueue({method:an.SETUP,headers:{Transport:"RTP/AVP/TCP;unicast;interleaved="+r+"-"+i},uri:o}),void 0!==this.clockrates&&(this.clockrates[r]=n)})),this._state===rn.PLAYING&&this._enqueue({method:an.PLAY,headers:{Range:`npt=${this.startTime||0}-`},uri:this._sessionControlURL}),this._dequeue()}play(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(this._state===rn.IDLE)this.startTime=Number(e)||0,this._enqueue({method:an.OPTIONS}),this._enqueue({method:an.DESCRIBE});else if(this._state===rn.PAUSED){if(null===this._sessionId||void 0===this._sessionId)throw new Error("rtsp: internal error");this._enqueue({method:an.PLAY,headers:{Session:this._sessionId},uri:this._sessionControlURL})}this._state=rn.PLAYING,this._dequeue()}pause(){this._enqueue({method:an.PAUSE}),this._state=rn.PAUSED,this._dequeue()}stop(){this._sessionId?this._enqueue({method:an.TEARDOWN}):this._callStack=[],this._state=rn.IDLE,null!==this._renewSessionInterval&&(clearInterval(this._renewSessionInterval),this._renewSessionInterval=null),this._dequeue()}send(e){const{method:t,headers:n,uri:r}=e;if(void 0===t)throw new Error("missing method when send request");if(this._waiting=!0,this.retry=this.send.bind(this,e),void 0===this._sequence||void 0===this.headers||void 0===this._callHistory)throw new Error("rtsp: internal error");const i=Object.assign({type:k.RTSP,uri:r||this._sessionControlURL,data:on.alloc(0)},{method:t,headers:n},{headers:Object.assign({CSeq:this._sequence++},this.defaultHeaders,this.headers[t],n)});this._sessionId&&(i.headers.Session=this._sessionId),this._callHistory.push(t),this._outgoingClosed?F()("msl:rtsp:outgoing")(`Unable to send ${t}, connection closed`):this.outgoing.push(i)}_enqueue(e){if(void 0===this._callStack)throw new Error("rtsp: internal error");this._callStack.push(e)}_dequeue(){if(void 0===this._callStack)throw new Error("rtsp: internal error");if(!this._waiting&&this._callStack.length>0){const e=this._callStack.shift();void 0!==e&&this.send(e)}}}const ln=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location.host,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.location.protocol;const n="https:"===t?"wss:":"ws:";return{uri:`${n}//${e}/rtsp-over-websocket`,tokenUri:`${t}//${e}/axis-cgi/rtspwssession.cgi`,protocol:"binary",timeout:10007}};var hn=n(764).Buffer;class dn extends l{constructor(e){if(void 0===e)throw new Error("socket argument missing");const t=new o.Readable({objectMode:!0,read:function(){}});e.onmessage=n=>{const r=hn.from(n.data);t.push({data:r,type:k.RAW})||e.readyState===WebSocket.OPEN&&(F()("msl:websocket:incoming")("downstream frozen"),e.close())},t.on("error",(t=>{console.warn("closing socket due to incoming error",t),e.close()}));const n=new o.Writable({objectMode:!0,write:function(t,n,r){try{e.send(t.data)}catch(e){console.warn("message lost during send:",t)}r()}});var r,i;n.on("error",(e=>{console.warn("error during websocket send, ignoring:",e)})),n.on("finish",(()=>{F()("msl:websocket:outgoing")("finish"),e.readyState!==WebSocket.CLOSED&&e.close()})),e.onclose=e=>{F()("msl:websocket:close")(`${e.code}`),1001===e.code&&this.onServerClose&&this.onServerClose(),t.push(null),n.end()},super(t,n),i=void 0,(r="onServerClose")in this?Object.defineProperty(this,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):this[r]=i}static async open(e){return await async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{uri:t,tokenUri:n,protocol:r,timeout:i}=en(ln(e.host,e.scheme),e);if(void 0===t)throw new Error("ws: internal error");return await new Promise(((e,o)=>{try{const s=new WebSocket(t,r),a=setTimeout((()=>{clearTimeout(a),s.readyState===WebSocket.CONNECTING&&(s.onerror=null,o(new Error("websocket connection timed out")))}),i);s.binaryType="arraybuffer",s.onerror=i=>{clearTimeout(a);const s=new XMLHttpRequest;s.addEventListener("load",(function(){if(this.status>=400)return console.warn("failed to load token",this.status,this.responseText),void o(i);const n=this.responseText.trim(),s=new WebSocket(`${t}?rtspwssession=${n}`,r);s.binaryType="arraybuffer",s.onerror=e=>{o(e)},s.onopen=()=>e(s)})),s.addEventListener("error",(e=>{console.warn("failed to get token"),o(e)})),s.addEventListener("abort",(()=>o(i))),s.open("GET",`${n}?${Date.now()}`);try{s.send()}catch(e){o(i)}},s.onopen=()=>{clearTimeout(a),e(s)}}catch(e){o(e)}}))}(e).then((e=>new dn(e)))}}function fn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class pn{constructor(){fn(this,"firstComponent",void 0),fn(this,"lastComponent",void 0),fn(this,"_set",void 0);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const[r,...i]=t;this._set=new Set(t),this.firstComponent=r,this.lastComponent=i.reduce(((e,t)=>e.connect(t)),r)}init(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const[r,...i]=t;this._set=new Set(t),this.firstComponent=r,this.lastComponent=i.reduce(((e,t)=>e.connect(t)),r)}insertAfter(e,t){if(!this._set.has(e))throw new Error("insertion point not part of pipeline");if(this._set.has(t))throw new Error("new component already in the pipeline");const n=e.next;return null===n?(e.connect(t),this.lastComponent=t):(e.disconnect(),e.connect(t).connect(n)),this._set.add(t),this}insertBefore(e,t){if(!this._set.has(e))throw new Error("insertion point not part of pipeline");if(this._set.has(t))throw new Error("new component already in the pipeline");const n=e.prev;return null===n?(t.connect(e),this.firstComponent=t):(n.disconnect(),n.connect(t).connect(e)),this._set.add(t),this}remove(e){if(!this._set.has(e))throw new Error("component not part of pipeline");const t=e.prev,n=e.next;if(null===t&&null===n)throw new Error("cannot remove last component");return null===t&&null!==n?(e.disconnect(),this.firstComponent=n):null!==t&&null===n?(t.disconnect(),this.lastComponent=t):null!==t&&null!==n&&(t.disconnect(),e.disconnect(),t.connect(n)),this._set.delete(e),this}append(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.forEach((e=>{this.insertAfter(this.lastComponent,e)})),this}prepend(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.forEach((e=>{this.insertBefore(this.firstComponent,e)})),this}}function mn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class gn extends pn{constructor(e){const t=new Qt,n=new un(e);n.onSdp=e=>{this.onSdp&&this.onSdp(e)},n.onPlay=e=>{this.onPlay&&this.onPlay(e)},super(t,n),mn(this,"onSdp",void 0),mn(this,"onPlay",void 0),mn(this,"rtsp",void 0),this.rtsp=n}}function yn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class bn extends gn{constructor(e){super(e),yn(this,"onSync",void 0),yn(this,"_mp4Muxer",void 0);const t=new J,n=new P,r=new st;r.onSync=e=>{this.onSync&&this.onSync(e)},this.append(t,n,r),this._mp4Muxer=r}get bitrate(){return this._mp4Muxer.bitrate}get framerate(){return this._mp4Muxer.framerate}}class vn extends gn{constructor(e){super(e);const t=new Re;this.append(t)}}var wn=n(758);function _n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class En{constructor(e,t,n){var r=this;_n(this,"realm",void 0),_n(this,"nonce",void 0),_n(this,"opaque",void 0),_n(this,"algorithm",void 0),_n(this,"qop",void 0),_n(this,"username",void 0),_n(this,"ha1Base",void 0),_n(this,"count",void 0),_n(this,"nc",(()=>(++this.count,this.count.toString(16).padStart(8,"0")))),_n(this,"cnonce",(()=>new Array(4).fill(0).map((()=>Math.floor(256*Math.random()))).map((e=>e.toString(16))).join(""))),_n(this,"ha1",(e=>{let t=this.ha1Base;return"md5-sess"===this.algorithm&&(t=(new wn.V).appendStr(`${t}:${this.nonce}:${e}`).end().toString()),t})),_n(this,"ha2",(function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=(new wn.V).appendStr(`${e}:${t}`).end().toString();if("md5-sess"===r.algorithm){const r=(new wn.V).appendStr(n).end().toString();i=(new wn.V).appendStr(`${e}:${t}:${r}`).end().toString()}return i})),_n(this,"authorization",(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"GET",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0;const i=r.nc(),o=r.cnonce(),s=r.ha1(o),a=r.ha2(e,t,n),c=void 0===r.qop?(new wn.V).appendStr(`${s}:${r.nonce}:${a}`).end().toString():(new wn.V).appendStr(`${s}:${r.nonce}:${i}:${o}:${r.qop}:${a}`).end().toString(),u=[];return u.push(`username="${r.username}"`),u.push(`realm="${r.realm}"`),u.push(`nonce="${r.nonce}"`),u.push(`uri="${t}"`),void 0!==r.qop&&(u.push(`qop=${r.qop}`),u.push(`nc=${i}`),u.push(`cnonce="${o}"`)),u.push(`response="${c}"`),void 0!==r.opaque&&u.push(`opaque="${r.opaque}"`),`Digest ${u.join(", ")}`}));const i=e.get("realm");if(void 0===i)throw new Error("no realm in digest challenge");this.realm=i,this.ha1Base=(new wn.V).appendStr(`${t}:${i}:${n}`).end().toString();const o=e.get("nonce");if(void 0===o)throw new Error("no nonce in digest challenge");this.nonce=o,this.opaque=e.get("opaque");const s=e.get("algorithm");void 0!==s?"md5"===s?this.algorithm="md5":"md5-sess"===s&&(this.algorithm="md5-sess"):this.algorithm="md5";const a=e.get("qop");if(void 0!==a){const e=a.split(",").map((e=>e.trim()));e.some((e=>"auth"===e))?this.qop="auth":e.some((e=>"auth-int"===e))&&(this.qop="auth-int")}this.count=0,this.username=t}}var Sn=n(764).Buffer;const Tn={username:"root",password:"pass"};class Rn extends h{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{username:t,password:n}=en(Tn,e);if(void 0===t||void 0===n)throw new Error("need username and password");let r,i;const o=I((function(e,t,n){e.type===k.RTSP&&(r=e,i&&e.headers&&(e.headers.Authorization=i)),n(void 0,e)}));super(I((function(e,s,a){if(e.type===k.RTSP&&401===$t(e.data)){const s=e.data.toString().split("\n").find((e=>/WWW-Auth/i.test(e)));if(void 0===s)throw new Error("cannot find WWW-Authenticate header");const c=(e=>{const[,t,...n]=e.split(" "),r=[],i=/\s*([^=]+)="([^"]*)",?/gm;let o;do{if(o=i.exec(n.join(" ")),null!==o){const[,e,t]=o;r.push([e,t])}}while(null!==o);const s=new Map(r);return{type:t.toLowerCase(),params:s}})(s);if("basic"===c.type)i="Basic "+Sn.from(t+":"+n).toString("base64");else{if("digest"!==c.type)return;{const e=new En(c.params,t,n);i=e.authorization(r.method,r.uri)}}o.write(r,(()=>a()))}else a(void 0,e)})),o)}}function Cn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class xn extends vn{constructor(e){const{ws:t,rtsp:n,mediaElement:r,auth:i}=e;if(super(n),Cn(this,"onCanplay",void 0),Cn(this,"onSync",void 0),Cn(this,"onServerClose",void 0),Cn(this,"ready",void 0),Cn(this,"_src",void 0),Cn(this,"_sink",void 0),i){const e=new Rn(i);this.insertBefore(this.rtsp,e)}const o=new D(r);o.onCanplay=()=>{o.play(),this.onCanplay&&this.onCanplay()},o.onSync=e=>{this.onSync&&this.onSync(e)},this.append(o),this._sink=o;const s=dn.open(t);this.ready=s.then((e=>{e.onServerClose=()=>{this.onServerClose&&this.onServerClose()},this.prepend(e),this._src=e}))}close(){this._src&&this._src.outgoing.end()}get currentTime(){return this._sink.currentTime}play(){return this._sink.play()}pause(){return this._sink.pause()}get bitrate(){return this._sink.bitrate}get framerate(){return this._sink.framerate}}function kn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class In extends bn{constructor(e){const{ws:t,rtsp:n,mediaElement:r,auth:i}=e;if(super(n),kn(this,"onSourceOpen",void 0),kn(this,"onServerClose",void 0),kn(this,"ready",void 0),kn(this,"tracks",void 0),kn(this,"_src",void 0),kn(this,"_sink",void 0),i){const e=new Rn(i);this.insertBefore(this.rtsp,e)}const o=new kt(r);o.onSourceOpen=(e,t)=>{this.tracks=t,this.onSourceOpen&&this.onSourceOpen(e,t)},this.append(o),this._sink=o;const s=dn.open(t);this.ready=s.then((e=>{e.onServerClose=()=>{this.onServerClose&&this.onServerClose()},this.prepend(e),this._src=e}))}close(){this._src&&this._src.outgoing.end()}get currentTime(){return this._sink.currentTime}async play(){return await this._sink.play()}pause(){return this._sink.pause()}}class Pn extends In{constructor(e){const{metadataHandler:t}=e;super(e);const n=new Pt;this.insertAfter(this.rtsp,n);const r=h.fromHandlers((e=>{e.type===k.XML&&t(e)}),void 0);this.insertAfter(n,r)}}function On(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Bn={parameters:["audio=0","video=0","event=on","ptz=all"]};class Ln extends gn{constructor(e){const{ws:t,rtsp:n,metadataHandler:r}=e;super(Object.assign({},Bn,n)),On(this,"onServerClose",void 0),On(this,"ready",void 0),On(this,"_src",void 0);const i=new Pt;this.append(i);const o=d.fromHandler((e=>{e.type===k.XML&&r(e)}));this.append(o);const s=dn.open(t);this.ready=s.then((e=>{e.onServerClose=()=>{this.onServerClose&&this.onServerClose()},this.prepend(e),this._src=e}))}close(){this._src&&this._src.outgoing.end()}}function An(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Mn extends gn{constructor(e){const{ws:t,rtsp:n,auth:r}=e;if(super(n),An(this,"onServerClose",void 0),An(this,"ready",void 0),An(this,"_src",void 0),r){const e=new Rn(r);this.insertBefore(this.rtsp,e)}const i=dn.open(t);this.ready=i.then((e=>{e.onServerClose=()=>{this.onServerClose&&this.onServerClose()},this.prepend(e),this._src=e}))}close(){this._src&&this._src.outgoing.end()}get sdp(){return this.ready.then((async()=>{const e=new Promise((e=>{this.rtsp.onSdp=e}));return this.rtsp.send({method:an.DESCRIBE}),this.rtsp.send({method:an.TEARDOWN}),e}))}}var Un=n(764).Buffer;function jn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Dn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Nn=F()("msl:http-mp4");class Fn extends l{constructor(e){const{uri:t,options:n}=e,r=new o.Readable({objectMode:!0,read:function(){}});r.on("error",(e=>{console.warn("closing socket due to incoming error",e),this._reader&&this._reader.cancel()})),super(r),Dn(this,"uri",void 0),Dn(this,"options",void 0),Dn(this,"length",void 0),Dn(this,"onHeaders",void 0),Dn(this,"onServerClose",void 0),Dn(this,"_reader",void 0),Dn(this,"_abortController",void 0),Dn(this,"_allDone",void 0),r._read=()=>{this._pull()},this.uri=t,this.options=n,this._allDone=!1}play(){if(void 0===this.uri)throw new Error("cannot start playing when there is no URI");this._abortController=new AbortController,this.length=0,fetch(this.uri,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?jn(Object(n),!0).forEach((function(t){Dn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({credentials:"include",signal:this._abortController.signal},this.options)).then((e=>{if(null===e.body)throw new Error("empty response body");const t=e.headers.get("Content-Type");this.incoming.push({data:Un.alloc(0),type:k.ISOM,mime:t}),this.onHeaders&&this.onHeaders(e.headers),this._reader=e.body.getReader(),this._pull()})).catch((e=>{console.error("http-source: fetch failed: ",e)}))}abort(){this._reader&&this._reader.cancel().catch((e=>{console.log("http-source: cancel reader failed: ",e)})),this._abortController&&this._abortController.abort()}_isClosed(){return this._allDone}_close(){var e;this._reader=void 0,this._allDone=!0,this.incoming.push(null),null===(e=this.onServerClose)||void 0===e||e.call(this)}_pull(){void 0!==this._reader&&this._reader.read().then((e=>{let{done:t,value:n}=e;if(t)return void(this._isClosed()||(Nn("fetch completed, total downloaded: ",this.length," bytes"),this._close()));if(void 0===n)throw new Error("expected value to be defined");if(void 0===this.length)throw new Error("expected length to be defined");this.length+=n.length;const r=Un.from(n);this.incoming.push({data:r,type:k.ISOM})?this._pull():Nn("downstream back pressure: pausing read")})).catch((e=>{Nn("http-source: read failed: ",e),this._isClosed()||this._close()}))}}function qn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Hn extends pn{constructor(e){const{http:t,mediaElement:n}=e,r=new Fn(t),i=new kt(n);r.onHeaders=e=>{this.onHeaders&&this.onHeaders(e)},r.onServerClose=()=>{var e;return null===(e=this.onServerClose)||void 0===e?void 0:e.call(this)},super(r,i),qn(this,"onHeaders",void 0),qn(this,"onServerClose",void 0),qn(this,"http",void 0),qn(this,"_src",void 0),qn(this,"_sink",void 0),this._src=r,this._sink=i,this.http=r}close(){this._src&&this._src.abort()}get currentTime(){return this._sink.currentTime}async play(){return await this._sink.play()}pause(){return this._sink.pause()}}const $n=function(e){let{maxRetries:t,errors:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{maxRetries:20,errors:[503]},r=0;const i=e.onError;e.onError=o=>{null==i||i(o),n.includes(o.code)&&((r+=1)>t?console.log("retry, too many",r,t):setTimeout((()=>{var t;return null===(t=e.retry)||void 0===t?void 0:t.call(e)}),100*r))}}})(),r})()}));